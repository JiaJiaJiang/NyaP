!function t(e,n,i){function a(s,r){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!r&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return a(n||t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(t,e,n){"use strict";function i(t){return"object"==typeof t}function a(t,e){let n,o,s;if("string"==typeof t||"number"==typeof t)return document.createTextNode(t);if(null!==t&&"object"==typeof t&&"_"in t!=!1&&"string"==typeof t._&&""!=t._){if(n=document.createElement(t._),i(t.attr))for(o in t.attr)n.setAttribute(o,t.attr[o]);if(i(t.prop))for(o in t.prop)n[o]=t.prop[o];if(i(t.event))for(o in t.event)n.addEventListener(o,t.event[o]);return i(t.child)&&t.child.length>0&&t.child.forEach(t=>{s=t instanceof Node?t:a(t,e);s instanceof Node&&n.appendChild(s)}),e&&e(n),n}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=a,n.Object2HTML=a},{}],2:[function(t,e,n){"use strict";!function(t,i){"function"==typeof define&&define.amd?define(i):"object"==typeof n?e.exports=i():t.ResizeSensor=i()}(void 0,function(){function t(t,e){var n=Object.prototype.toString.call(t),i="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"[object Object]"===n||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,a=0,o=t.length;if(i)for(;a<o;a++)e(t[a]);else e(t)}if("undefined"==typeof window)return null;var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)},n=function(i,a){function o(){var t=[];this.add=function(e){t.push(e)};var e,n;this.call=function(){for(e=0,n=t.length;e<n;e++)t[e].call()},this.remove=function(i){var a=[];for(e=0,n=t.length;e<n;e++)t[e]!==i&&a.push(t[e]);t=a},this.length=function(){return t.length}}function s(t,e){return t.currentStyle?t.currentStyle[e]:window.getComputedStyle?window.getComputedStyle(t,null).getPropertyValue(e):t.style[e]}function r(t,n){if(t.resizedAttached)return void t.resizedAttached.add(n);t.resizedAttached=new o,t.resizedAttached.add(n),t.resizeSensor=document.createElement("div"),t.resizeSensor.className="resize-sensor";var i="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",a="position: absolute; left: 0; top: 0; transition: 0s;";t.resizeSensor.style.cssText=i,t.resizeSensor.innerHTML='<div class="resize-sensor-expand" style="'+i+'"><div style="'+a+'"></div></div><div class="resize-sensor-shrink" style="'+i+'"><div style="'+a+' width: 200%; height: 200%"></div></div>',t.appendChild(t.resizeSensor),"static"==s(t,"position")&&(t.style.position="relative");var r,l,u,c,d=t.resizeSensor.childNodes[0],h=d.childNodes[0],f=t.resizeSensor.childNodes[1],m=t.offsetWidth,p=t.offsetHeight,g=function(){h.style.width="100000px",h.style.height="100000px",d.scrollLeft=1e5,d.scrollTop=1e5,f.scrollLeft=1e5,f.scrollTop=1e5};g();var _=function(){l=0,r&&(m=u,p=c,t.resizedAttached&&t.resizedAttached.call())},k=function(){u=t.offsetWidth,c=t.offsetHeight,r=u!=m||c!=p,r&&!l&&(l=e(_)),g()},y=function(t,e,n){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n)};y(d,"scroll",k),y(f,"scroll",k)}t(i,function(t){r(t,a)}),this.detach=function(t){n.detach(i,t)}};return n.detach=function(e,n){t(e,function(t){t.resizedAttached&&"function"==typeof n&&(t.resizedAttached.remove(n),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached)})},n})},{}],3:[function(t,e,n){"use strict";function i(t,e={}){for(let n in e)n.split(/\,/g).forEach(i=>t.addEventListener(i,e[n]))}Object.defineProperty(n,"__esModule",{value:!0}),n.ResizeSensor=n.DanmakuFrameModule=n.DanmakuFrame=void 0;var a=t("../lib/ResizeSensor.js"),o=function(t){return t&&t.__esModule?t:{default:t}}(a);class s{constructor(t){this.container=t||document.createElement("div"),this.rate=1,this.timeBase=this.width=this.height=this.fps=0,this.media=null,this.working=!1,this.modules={},this.moduleList=[];const e=document.createElement("style");document.head.appendChild(e),this.styleSheet=e.sheet;for(let t in s.moduleList)this.initModule(t);setTimeout(()=>{this.container.ResizeSensor=new o.default(this.container,()=>{this.resize()});this.resize()},0),this.draw=this.draw.bind(this)}enable(t){let e=this.modules[t];return e?(e.enabled=!0,e.enable&&e.enable(),!0):this.initModule(t)}disable(t){let e=this.modules[t];return!!e&&(e.enabled=!1,e.disable&&e.disable(),!0)}addStyle(t){"string"==typeof t&&(t=[t]),t instanceof Array!=!1&&t.forEach(t=>this.styleSheet.insertRule(t,this.styleSheet.cssRules.length))}initModule(t){let e=s.moduleList[t];if(!e)throw"Module ["+t+"] does not exist.";let n=new e(this);if(n instanceof r==!1)throw"Constructor of "+t+" is not extended from DanmakuFrameModule";return n.enabled=!0,this.modules[t]=n,this.moduleList.push(t),console.debug(`Mod Inited: ${t}`),!0}set time(t){this.media||(this.timeBase=Date.now()-t),this.moduleFunction("time",t)}get time(){return this.media?1e3*this.media.currentTime|0:Date.now()-this.timeBase}draw(t){this.working&&(this.moduleFunction("draw",t),0===this.fps?requestAnimationFrame(this.draw):setTimeout(this.draw,1e3/this.fps))}load(t){this.moduleFunction("load",t)}loadList(t){this.moduleFunction("loadList",t)}unload(t){this.moduleFunction("unload",t)}start(){this.working||(this.working=!0,this.moduleFunction("start"),this.draw(!0))}pause(){this.working=!1,this.moduleFunction("pause")}resize(){this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.moduleFunction("resize")}moduleFunction(t,e){for(let n,i=0;i<this.moduleList.length;i++)n=this.modules[this.moduleList[i]],n[t]&&n.enabled&&n[t](e)}setMedia(t){this.media=t,i(t,{playing:()=>this.start(),pause:()=>this.pause(),ratechange:()=>this.rate=this.media.playbackRate}),this.moduleFunction("media",t)}static addModule(t,e){if(t in this.moduleList)return void console.warn('The module "'+t+'" has already been added.');this.moduleList[t]=e}}s.moduleList={};class r{constructor(t){this.frame=t,this.enabled=!1}}n.DanmakuFrame=s,n.DanmakuFrameModule=r,n.ResizeSensor=o.default},{"../lib/ResizeSensor.js":2}],4:[function(t,e,n){"use strict";!function(t){"function"==typeof define&&define.amd?define(t):"object"==typeof n?e.exports=t():(0,eval)("this").Mat=t()}(function(){function t(e){function i(t,n,i){const o=new e(t*n);return Object.setPrototypeOf(o,a),Object.defineProperty(o,"length",{value:t*n}),Object.defineProperty(o,"row",{value:t}),Object.defineProperty(o,"column",{value:n}),arguments.length>=3&&(a._instanceofTypedArray&&0===i||("number"==typeof i?o.fill(i):i.length&&o.set(i))),o}class a{get length(){return this._len}static leftMultiply(t){return this.set(i.multiply(t,this,i(t.row,this.column)))}static rightMultiply(t){return this.set(i.multiply(this,t,i(this.row,t,column)))}static fill(t){arguments.length||(t=0);for(let e=this.length;e--;)this[e]=t;return this}static set(t,e){e||(e=0);for(let n=t.length+e<=this.length?t.length:this.length-e;n--;)this[e+n]=t[n];return this}static put(t,e,n){return i.put(this,t,e||0,n||0),this}static rotate2d(t){return this.set(i.rotate2d(this,t,i.Matrixes.T3))}static translate2d(t,e){return this.set(i.translate2d(this,t,e,i.Matrixes.T3))}static scale2d(t,e){return this.set(i.scale2d(this,t,e,i.Matrixes.T3))}static rotate3d(t,e,n){return this.set(i.rotate3d(this,t,e,n,i.Matrixes.T4))}static scale3d(t,e,n){return this.set(i.scale3d(this,t,e,n,i.Matrixes.T4))}static translate3d(t,e,n){return this.set(i.translate3d(this,t,e,n,i.Matrixes.T4))}static rotateX(t){return this.set(i.rotateX(this,t,i.Matrixes.T4))}static rotateY(t){return this.set(i.rotateY(this,t,i.Matrixes.T4))}static rotateZ(t){return this.set(i.rotateZ(this,t,i.Matrixes.T4))}static clone(){return i(this.row,this.column,this)}static toString(){if(0===this.length)return"";for(var t=0,e=[],n=[];t<this.length;t++)t&&t%this.column==0&&(e.push(n.join("\t")),n.length=0),n.push(this[t]||0);return e.push(n.join("\t")),e.join("\n")}}class o{static Identity(t){let e=i(t,t,0);for(let n=t;n--;)e[n*t+n]=1;return e}static Perspective(t,e,n,a,o){var s=n*Math.tan(t*Math.PI/360),r=s*e,l=o||i(4,4,0);return l[0]=2*n/(r+r),l[5]=2*n/(s+s),l[10]=-(a+n)/(a-n),l[14]=-2*a*n/(a-n),l[11]=-1,o&&(l[1]=l[2]=l[3]=l[4]=l[6]=l[7]=l[8]=l[9]=l[12]=l[13]=l[15]=0),l}static multiply(t,e,n){if(t.column!==e.row)throw"wrong matrix";let a,o,s,r=t.row,l=Math.min(t.column,e.column),u=n||i(r,l);for(let n=r;n--;)for(a=l;a--;)for(u[s=n*u.column+a]=0,o=t.column;o--;)u[s]+=t[n*t.column+o]*e[a+o*e.column];return u}static multiplyString(t,e,n,a=!0){if(t.column!==e.row)throw"wrong matrix";var o,s,r,l,u=n||i(t.row,e.column);for(o=t.row;o--;)for(s=e.column;s--;)for(u[l=o*e.column+s]="",r=0;r<t.column;r++)(!a||0!=t[o*t.column+r]&&0!=e[s+r*e.column])&&(u[l]+=(r&&u[l]?"+":"")+"("+t[o*t.column+r]+")*("+e[s+r*e.column]+")");return u}static add(t,e,n){if(t.column!==e.column||t.row!==e.row)throw"wrong matrix";let a=n||i(t.row,e.column);for(let n=t.length;n--;)a[n]=t[n]+e[n];return a}static minus(t,e,n){if(t.column!==e.column||t.row!==e.row)throw"wrong matrix";let a=n||i(t.row,e.column);for(let n=t.length;n--;)a[n]=t[n]-e[n];return a}static rotate2d(t,e,n){const a=i.Matrixes.rotate2d;return a[0]=a[4]=Math.cos(e),a[1]=-(a[3]=Math.sin(e)),i.multiply(a,t,n||i(3,3))}static scale2d(t,e,n,a){const o=i.Matrixes.scale2d;return o[0]=e,o[4]=n,i.multiply(o,t,a||i(3,3))}static translate2d(t,e,n,a){const o=i.Matrixes.translate2d;return o[2]=e,o[5]=n,i.multiply(o,t,a||i(3,3))}static rotate3d(t,e,n,a,o){const s=Math.cos(e),r=Math.sin(e),l=Math.cos(n),u=Math.sin(n),c=Math.cos(a),d=Math.sin(a),h=i.Matrixes.rotate3d;return h[0]=c*l,h[1]=c*u*r-d*s,h[2]=c*u*s+d*r,h[4]=d*l,h[5]=d*u*r+c*s,h[6]=d*u*s-c*r,h[8]=-u,h[9]=l*r,h[10]=l*s,i.multiply(h,t,o||i(4,4))}static rotateX(t,e,n){const a=i.Matrixes.rotateX;return a[10]=a[5]=Math.cos(e),a[6]=-(a[9]=Math.sin(e)),i.multiply(a,t,n||i(4,4))}static rotateY(t,e,n){const a=i.Matrixes.rotateY;return a[10]=a[0]=Math.cos(e),a[8]=-(a[2]=Math.sin(e)),i.multiply(a,t,n||i(4,4))}static rotateZ(t,e,n){const a=i.Matrixes.rotateZ;return a[5]=a[0]=Math.cos(e),a[1]=-(a[4]=Math.sin(e)),i.multiply(a,t,n||i(4,4))}static scale3d(t,e,n,a,o){const s=i.Matrixes.scale3d;return s[0]=e,s[5]=n,s[10]=a,i.multiply(s,t,o||i(4,4))}static translate3d(t,e,n,a,o){const s=i.Matrixes.translate3d;return s[12]=e,s[13]=n,s[14]=a,i.multiply(s,t,o||i(4,4))}static put(t,e,n,i){let a;n||(n=0),i||(i=0);for(let o=e.row;o--;)if(!(o+n>=t.row))for(a=e.column;a--;)a+i>=t.column||(t[(o+n)*t.column+a+i]=e[o*e.column+a])}static createClass(e){return t(e)}}var s=new e(1);return Object.defineProperty(a,"_instanceofTypedArray",{value:!(!n||!n.isPrototypeOf(s))}),s=null,Object.setPrototypeOf(a,e.prototype),Object.setPrototypeOf(i,o),i.Matrixes={I2:i.Identity(2),I3:i.Identity(3),I4:i.Identity(4),T3:i(3,3,0),T4:i(4,4,0),rotate2d:i.Identity(3),translate2d:i.Identity(3),scale2d:i.Identity(3),translate3d:i.Identity(4),rotate3d:i.Identity(4),rotateX:i.Identity(4),rotateY:i.Identity(4),rotateZ:i.Identity(4),scale3d:i.Identity(4)},i}const e=(0,eval)("this"),n=e.Float32Array&&e.Float32Array.prototype;return t(e.Float32Array?Float32Array:Array)})},{}],5:[function(t,e,n){(function(t,e){"use strict";!function(e,n){function i(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return u[l]=i,r(l),l++}function a(t){delete u[t]}function o(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}}function s(t){if(c)setTimeout(s,0,t);else{var e=u[t];if(e){c=!0;try{o(e)}finally{a(t),c=!1}}}}if(!e.setImmediate){var r,l=1,u={},c=!1,d=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?function(){r=function(e){t.nextTick(function(){s(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&s(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),r=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){s(t.data)},r=function(e){t.port2.postMessage(e)}}():d&&"onreadystatechange"in d.createElement("script")?function(){var t=d.documentElement;r=function(e){var n=d.createElement("script");n.onreadystatechange=function(){s(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){r=function(t){setTimeout(s,0,t)}}(),h.setImmediate=i,h.clearImmediate=a}}("undefined"==typeof self?void 0===e?void 0:e:self)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:11}],6:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){function n(t,e,n,i,a=!1){if(0===t.length)return 0;let o=n,s=i;for(;n<=i;)o=n+i>>1,e<=t[o].time?i=o-1:n=o+1;if(a)for(;n>0&&t[n-1].time===e;)n--;else for(;n<=s&&t[n].time===e;)n++;return n}const i=Object.defineProperty,a=window.requestIdleCallback||setImmediate;let s=!1;class l extends e{constructor(t){super(t),this.list=[],this.indexMark=0,this.tunnel=new h,this.paused=!0,this.randomText=`danmaku_text_${999999*Math.random()|0}`,this.defaultStyle={fontStyle:null,fontWeight:300,fontVariant:null,color:"#fff",fontSize:24,fontFamily:"Arial",strokeWidth:1,strokeColor:"#888",shadowBlur:5,textAlign:"start",shadowColor:"#000",shadowOffsetX:0,shadowOffsetY:0,fill:!0},this.defaultStyle.__defineGetter__("lineHeight",function(){return this.fontSize+2}),t.addStyle(`.${this.randomText}_fullfill{top:0;left:0;width:100%;height:100%;position:absolute;}`),i(this,"renderMode",{configurable:!0}),i(this,"activeRenderMode",{configurable:!0,value:null});const e=this.container=document.createElement("div");e.classList.add(`${this.randomText}_fullfill`),t.container.appendChild(e),this.text2d=new r.default(this),this.text3d=new u.default(this),this.textCanvas=new d.default(this),this.textCanvasContainer.hidden=this.canvas.hidden=this.canvas3d.hidden=!0,this.modes={1:this.textCanvas,2:this.text2d,3:this.text3d},this.GraphCache=[],this.DanmakuText=[],this.cacheCleanTime=0,this.danmakuMoveTime=0,this.danmakuCheckTime=0,this.danmakuCheckSwitch=!0,this.options={allowLines:!1,screenLimit:0,clearWhenTimeReset:!0,speed:6.5},o(document,{visibilitychange:t=>{this.danmakuCheckSwitch=!document.hidden;document.hidden||this.recheckIndexMark()}}),this._checkNewDanmaku=this._checkNewDanmaku.bind(this),this._cleanCache=this._cleanCache.bind(this),setInterval(this._cleanCache,5e3),this.setRenderMode(1)}setRenderMode(t){this.renderMode!==t&&t in this.modes&&this.modes[t].supported&&(this.activeRenderMode&&this.activeRenderMode.disable(),i(this,"activeRenderMode",{value:this.modes[t]}),i(this,"renderMode",{value:t}),this.activeRenderMode.resize(),this.activeRenderMode.enable())}media(t){o(t,{seeked:()=>{this.start();this.time();this._clearScreen()},seeking:()=>this.pause(),stalled:()=>this.pause()})}start(){this.paused=!1,this.recheckIndexMark(),this.activeRenderMode.start()}pause(){this.paused=!0,this.activeRenderMode.pause()}load(t){if(!t||"text"!==t._)return!1;if("string"!=typeof t.text)return console.error("wrong danmaku object:",t),!1;let e,i=(t.time,this.list);return e=n(i,t.time,0,i.length-1,!1),i.splice(e,0,t),e<this.indexMark&&this.indexMark++,"object"!=typeof t.style&&(t.style={}),t.style.fontSize=t.style.fontSize?t.style.fontSize+.5|0:this.defaultStyle.fontSize,(isNaN(t.style.fontSize)||t.style.fontSize===1/0||0===t.style.fontSize)&&(t.style.fontSize=this.defaultStyle.fontSize),"number"!=typeof t.mode&&(t.mode=0),t}loadList(t){t.forEach(t=>this.load(t))}unload(t){if(!t||"text"!==t._)return!1;const e=this.list.indexOf(t);return!(e<0)&&(this.list.splice(e,1),e<this.indexMark&&this.indexMark--,!0)}_checkNewDanmaku(){let t,e=this.frame.time;if(this.danmakuCheckTime!==e&&this.danmakuCheckSwitch){if(this.list.length)for(;this.indexMark<this.list.length&&(t=this.list[this.indexMark])&&t.time<=e;this.indexMark++)this.options.screenLimit>0&&this.DanmakuText.length>=this.options.screenLimit||this._addNewDanmaku(t);this.danmakuCheckTime=e}}_addNewDanmaku(t){const e=this.height,n=this.width;let i=this.GraphCache.length?this.GraphCache.shift():new c;i.danmaku=t,i.drawn=!1,i.text=this.options.allowLines?t.text:t.text.replace(/\n/g," "),i.time=t.time,Object.setPrototypeOf(i.font,this.defaultStyle),Object.assign(i.font,t.style),t.style.color&&i.font.color&&"#"!==i.font.color[0]&&(i.font.color="#"+t.style.color),t.mode>1&&(i.font.textAlign="center"),i.prepare(3!==this.renderMode);const a=this.tunnel.getTunnel(i,e);let o=(a<0?0:a)%e;switch(t.mode){case 0:case 1:case 3:i.style.y=o;break;case 2:i.style.y=e-o-i.style.height-1}switch(t.mode){case 0:i.style.x=n;break;case 1:i.style.x=-i.style.width;break;case 2:case 3:i.style.x=(n-i.style.width)/2}this.DanmakuText.push(i),this.activeRenderMode.newDanmaku(i)}_calcSideDanmakuPosition(t,e,n){let i=!t.danmaku.mode,a=t.style;return(i?n:-a.width)+(i?-1:1)*this.frame.rate*(a.width+1024)*(e-t.time)*this.options.speed/6e4}_calcDanmakusPosition(t){let e=this.frame.time;if(!t){if(this.paused)return;if(this.danmakuMoveTime===e)return void this.pause()}const n=this.width;let i,a,o,s,r,l=this.frame.rate;for(this.danmakuMoveTime=e,a=this.DanmakuText.length;a--;)if(o=this.DanmakuText[a],o.time>e)this.removeText(o);else switch(s=o.style,o.danmaku.mode){case 0:case 1:if(i=!o.danmaku.mode,s.x=r=this._calcSideDanmakuPosition(o,e,n),o.tunnelNumber>=0&&(i&&r+s.width+10<n||!i&&r>10))this.tunnel.removeMark(o);else if(i&&r<-s.width-20||!i&&r>n+s.width+20){this.removeText(o);continue}break;case 2:case 3:e-o.time>1e3*this.options.speed/l&&this.removeText(o)}}_cleanCache(t){const e=Date.now();if(this.GraphCache.length>30||t)for(let n=0;n<this.GraphCache.length&&(t||e-this.GraphCache[n].removeTime>1e4);n++)this.activeRenderMode.deleteTextObject(this.GraphCache[n]),this.GraphCache.splice(n,1)}draw(t){!t&&this.paused||!this.enabled||(this._calcDanmakusPosition(t),this.activeRenderMode.draw(t),a(this._checkNewDanmaku))}removeText(t){let e=this.DanmakuText.indexOf(t);e>=0&&this.DanmakuText.splice(e,1),this.tunnel.removeMark(t),t._bitmap=t.danmaku=null,t.removeTime=Date.now(),this.GraphCache.push(t),this.activeRenderMode.remove(t)}resize(){this.activeRenderMode&&this.activeRenderMode.resize(),this.draw(!0)}_clearScreen(t){this.activeRenderMode&&this.activeRenderMode.clear(t)}clear(){for(let t,e=this.DanmakuText.length;e--;)t=this.DanmakuText[e],t.danmaku&&this.removeText(t);this.tunnel.reset(),this._clearScreen(!0)}recheckIndexMark(t=this.frame.time){this.indexMark=n(this.list,t,0,this.list.length-1,!0)}time(t=this.frame.time){this.recheckIndexMark(t),this.options.clearWhenTimeReset?this.clear():this.resetTimeOfDanmakuOnScreen()}resetTimeOfDanmakuOnScreen(t){void 0===t&&(t=this.frame.time),this.DanmakuText.forEach(e=>{if(!e.danmaku)return;e.time=t-(this.danmakuMoveTime-e.time)})}danmakuAt(t,e){const n=[];return this.enabled?(this.DanmakuText.forEach(i=>{if(!i.danmaku)return;i.style.x<=t&&i.style.x+i.style.width>=t&&i.style.y<=e&&i.style.y+i.style.height>=e&&n.push(i.danmaku)}),n):n}enable(){this.textCanvasContainer.hidden=!1,this.frame.working&&this.start()}disable(){this.textCanvasContainer.hidden=!0,this.pause(),this.clear()}set useImageBitmap(t){s="function"==typeof createImageBitmap&&t}get useImageBitmap(){return s}get width(){return this.frame.width}get height(){return this.frame.height}}class c{constructor(t=""){this._fontString="",this._renderList=null,this.style={},this.font={},this.text=t,this._renderToCache=this._renderToCache.bind(this),i(this,"_cache",{configurable:!0})}prepare(t=!1){this._cache||i(this,"_cache",{value:document.createElement("canvas")});let e=[];this.font.fontStyle&&e.push(this.font.fontStyle),this.font.fontVariant&&e.push(this.font.fontVariant),this.font.fontWeight&&e.push(this.font.fontWeight),e.push(`${this.font.fontSize}px`),this.font.fontFamily&&e.push(this.font.fontFamily),this._fontString=e.join(" ");const n=this._cache,o=n.ctx2d||(n.ctx2d=n.getContext("2d"));o.font=this._fontString,this._renderList=this.text.split(/\n/g),this.estimatePadding=Math.max(this.font.shadowBlur+5+Math.max(Math.abs(this.font.shadowOffsetY),Math.abs(this.font.shadowOffsetX)),this.font.strokeWidth+3);let s,r=0,l="number"==typeof this.font.lineHeight?this.font.lineHeight:this.font.fontSize;for(let t=this._renderList.length;t--;)(s=o.measureText(this._renderList[t]).width)>r&&(r=s);n.width=(this.style.width=r)+2*this.estimatePadding,n.height=(this.style.height=this._renderList.length*l)+(l<this.font.fontSize?2*this.font.fontSize:0)+2*this.estimatePadding,o.translate(this.estimatePadding,this.estimatePadding),t?a(this._renderToCache):this._renderToCache()}_renderToCache(){this.danmaku&&(this.render(this._cache.ctx2d),s&&(this._bitmap&&(this._bitmap.close(),this._bitmap=null),createImageBitmap(this._cache).then(t=>{this._bitmap=t})))}render(t){if(this._renderList){t.save(),this.danmaku.highlight&&(t.fillStyle="rgba(255,255,255,0.3)",t.beginPath(),t.rect(0,0,this.style.width,this.style.height),t.fill()),t.font=this._fontString,t.textBaseline="middle",t.lineWidth=this.font.strokeWidth,t.fillStyle=this.font.color,t.strokeStyle=this.font.strokeColor,t.shadowBlur=this.font.shadowBlur,t.shadowColor=this.font.shadowColor,t.shadowOffsetX=this.font.shadowOffsetX,t.shadowOffsetY=this.font.shadowOffsetY,t.textAlign=this.font.textAlign;let e,n="number"==typeof this.font.lineHeight?this.font.lineHeight:this.font.fontSize;switch(this.font.textAlign){case"left":case"start":e=0;break;case"center":e=this.style.width/2;break;case"right":case"end":e=this.style.width}for(let i=this._renderList.length;i--;)this.font.strokeWidth&&t.strokeText(this._renderList[i],e,n*(i+.5)),this.font.fill&&t.fillText(this._renderList[i],e,n*(i+.5));t.restore()}}}class h{constructor(){this.reset()}reset(){this.right={},this.left={},this.bottom={},this.top={}}getTunnel(t,e){let n=this.tunnel(t.danmaku.mode),i=t.style.height,a=0,o=-1;if(("number"!=typeof i||i<=0)&&(console.error("Incorrect size:"+i),i=24),i>e)return 0;for(;o<0;)for(let t=a+i-1;a<=t;){if(n[a]){a+=n[a].tunnelHeight;break}if(0!==a&&a%(e-1)==0){a++;break}if(a===t){o=a-i+1;break}a++}return t.tunnelNumber=o,t.tunnelHeight=t.style.y+i>e?1:i,this.addMark(t),o}addMark(t){let e=this.tunnel(t.danmaku.mode);e[t.tunnelNumber]||(e[t.tunnelNumber]=t)}removeMark(t){let e,n=t.tunnelNumber;n>=0&&(e=this.tunnel(t.danmaku.mode))[n]===t&&(delete e[n],t.tunnelNumber=-1)}tunnel(t){return this[f[t]]}}const f=["right","left","bottom","top"];t.addModule("TextDanmaku",l)}function o(t,e={}){for(let n in e)n.split(/\,/g).forEach(i=>t.addEventListener(i,e[n]))}Object.defineProperty(n,"__esModule",{value:!0}),t("../lib/setImmediate/setImmediate.js");var s=t("./text2d.js"),r=i(s),l=t("./text3d.js"),u=i(l),c=t("./textCanvas.js"),d=i(c);n.default=a},{"../lib/setImmediate/setImmediate.js":5,"./text2d.js":7,"./text3d.js":8,"./textCanvas.js":9}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./textModuleTemplate.js"),a=function(t){return t&&t.__esModule?t:{default:t}}(i);class o extends a.default{constructor(t){if(super(t),this.supported=!1,t.canvas=document.createElement("canvas"),t.context2d=t.canvas.getContext("2d"),!t.context2d)return void console.warn("text 2d not supported");t.canvas.classList.add(`${t.randomText}_fullfill`),t.canvas.id=`${t.randomText}_text2d`,t.container.appendChild(t.canvas),this.supported=!0}draw(t){let e,n=this.dText.context2d,i=n.canvas.width,a=this.dText.DanmakuText,o=a.length;for(n.globalCompositeOperation="destination-over",this.clear(t);o--;)(e=a[o]).drawn||(e.drawn=!0),i>=e._cache.width?n.drawImage(e._bitmap||e._cache,e.style.x-e.estimatePadding,e.style.y-e.estimatePadding):e.style.x-e.estimatePadding>=0?n.drawImage(e._bitmap||e._cache,0,0,i,e._cache.height,e.style.x-e.estimatePadding,e.style.y-e.estimatePadding,i,e._cache.height):e.style.x-e.estimatePadding+e._cache.width<=i?n.drawImage(e._bitmap||e._cache,e.estimatePadding-e.style.x,0,e.style.x-e.estimatePadding+e._cache.width,e._cache.height,0,e.style.y-e.estimatePadding,e.style.x-e.estimatePadding+e._cache.width,e._cache.height):n.drawImage(e._bitmap||e._cache,e.estimatePadding-e.style.x,0,i,e._cache.height,0,e.style.y-e.estimatePadding,i,e._cache.height)}clear(t){const e=this.dText;if(t||this._evaluateIfFullClearMode())return void e.context2d.clearRect(0,0,e.canvas.width,e.canvas.height);for(let t,n=e.DanmakuText.length;n--;)t=e.DanmakuText[n],t.drawn&&e.context2d.clearRect(t.style.x-t.estimatePadding,t.style.y-t.estimatePadding,t._cache.width,t._cache.height)}_evaluateIfFullClearMode(){if(this.dText.DanmakuText.length>3)return!0;let t=this.dText.GraphCache[this.dText.GraphCache.length-1];return!(!t||!t.drawn)&&(t.drawn=!1,!0)}resize(){let t=this.dText,e=t.canvas;e.width=t.width,e.height=t.height}enable(){this.draw(),this.dText.useImageBitmap=!(this.dText.canvas.hidden=!1)}disable(){this.dText.canvas.hidden=!0}}n.default=o},{"./textModuleTemplate.js":10}],8:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var a=t("../lib/Mat/Mat.js"),o=i(a),s=t("./textModuleTemplate.js"),r=i(s);const l=window.requestIdleCallback||setImmediate;class u extends r.default{constructor(t){function e(t){var e=n.createShader(i[t][0]);if(n.shaderSource(e,i[t][1]),n.compileShader(e),!n.getShaderParameter(e,n.COMPILE_STATUS))throw"An error occurred compiling the shaders: "+n.getShaderInfoLog(e);return e}if(super(t),this.supported=!1,t.canvas3d=document.createElement("canvas"),t.canvas3d.classList.add(`${t.randomText}_fullfill`),t.canvas3d.id=`${t.randomText}_text3d`,t.context3d=t.canvas3d.getContext("webgl"),t.context3d||(t.context3d=t.canvas3d.getContext("expeimental-webgl")),!t.context3d)return void console.warn("text 3d not supported");t.container.appendChild(t.canvas3d);const n=this.gl=t.context3d;t.canvas3d;var i={danmakuFrag:[n.FRAGMENT_SHADER,`
\t\t\t\tvarying lowp vec2 vDanmakuTexCoord;
\t\t\t\tuniform sampler2D uSampler;
\t\t\t\tvoid main(void) {
\t\t\t\t\tgl_FragColor = texture2D(uSampler,vDanmakuTexCoord);
\t\t\t\t}`],danmakuVert:[n.VERTEX_SHADER,`
\t\t\t\tattribute vec2 aVertexPosition;
\t\t\t\tattribute vec2 aDanmakuTexCoord;
\t\t\t\tuniform mat4 u2dCoordinate;
\t\t\t\tuniform vec2 uDanmakuPos;
\t\t\t\tvarying lowp vec2 vDanmakuTexCoord;
\t\t\t\tvoid main(void) {
\t\t\t\t\tgl_Position = u2dCoordinate * vec4(aVertexPosition+uDanmakuPos,0,1);
\t\t\t\t\tvDanmakuTexCoord = aDanmakuTexCoord;
\t\t\t\t}`]},a=e("danmakuFrag"),o=e("danmakuVert"),s=this.shaderProgram=n.createProgram();if(n.attachShader(s,o),n.attachShader(s,a),n.linkProgram(s),!n.getProgramParameter(s,n.LINK_STATUS))return void console.error("Unable to initialize the shader program.");n.useProgram(s),n.clearColor(0,0,0,0),n.enable(n.BLEND),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA),this.maxTexSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.uSampler=n.getUniformLocation(s,"uSampler"),this.u2dCoord=n.getUniformLocation(s,"u2dCoordinate"),this.uDanmakuPos=n.getUniformLocation(s,"uDanmakuPos"),this.aVertexPosition=n.getAttribLocation(s,"aVertexPosition"),this.atextureCoord=n.getAttribLocation(s,"aDanmakuTexCoord"),n.enableVertexAttribArray(this.aVertexPosition),n.enableVertexAttribArray(this.atextureCoord),this.commonTexCoordBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.commonTexCoordBuffer),n.bufferData(n.ARRAY_BUFFER,c,n.STATIC_DRAW),n.vertexAttribPointer(this.atextureCoord,2,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),n.uniform1i(this.uSampler,0),this.supported=!0}draw(t){const e=this.gl,n=this.dText.DanmakuText.length;for(let t,i=0;i<n;i++)(t=this.dText.DanmakuText[i])&&t.glDanmaku&&(e.uniform2f(this.uDanmakuPos,t.style.x-t.estimatePadding,t.style.y-t.estimatePadding),e.bindBuffer(e.ARRAY_BUFFER,t.verticesBuffer),e.vertexAttribPointer(this.aVertexPosition,2,e.FLOAT,!1,0,0),e.bindTexture(e.TEXTURE_2D,t.texture),e.drawArrays(e.TRIANGLE_STRIP,0,4));e.flush()}clear(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)}deleteTextObject(t){const e=this.gl;t.texture&&e.deleteTexture(t.texture),t.verticesBuffer&&e.deleteBuffer(t.verticesBuffer),t.textureCoordBuffer&&e.deleteBuffer(t.textureCoordBuffer)}resize(t,e){const n=this.gl,i=this.dText.canvas3d;i.width=this.dText.width,i.height=this.dText.height,n.viewport(0,0,i.width,i.height),n.uniformMatrix4fv(this.u2dCoord,!1,o.default.Identity(4).translate3d(-1,1,0).scale3d(2/i.width,-2/i.height,0))}enable(){this.dText.DanmakuText.forEach(t=>{this.newDanmaku(t,!1)}),this.dText.useImageBitmap=this.dText.canvas3d.hidden=!1,requestAnimationFrame(()=>this.draw())}disable(){this.dText._cleanCache(!0),this.dText.canvas3d.hidden=!0}newDanmaku(t,e=!0){const n=this.gl;if(t.glDanmaku=!1,t._cache.height>this.maxTexSize||t._cache.width>this.maxTexSize)return void console.warn("Ignore a danmaku width too large size",t.danmaku);let i;(i=t.texture)||(i=t.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),e?l(()=>{n.bindTexture(n.TEXTURE_2D,i);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t._cache);t.glDanmaku=!0}):(n.bindTexture(n.TEXTURE_2D,i),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t._cache),t.glDanmaku=!0),t.verticesBuffer||(t.verticesBuffer=n.createBuffer()),n.bindBuffer(n.ARRAY_BUFFER,t.verticesBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,t._cache.width,0,0,t._cache.height,t._cache.width,t._cache.height]),n.STATIC_DRAW)}}const c=new Float32Array([0,0,1,0,0,1,1,1]);n.default=u},{"../lib/Mat/Mat.js":4,"./textModuleTemplate.js":10}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./textModuleTemplate.js"),a=function(t){return t&&t.__esModule?t:{default:t}}(i);class o extends a.default{constructor(t){super(t),this.supported=t.text2d.supported,this.supported&&(t.frame.addStyle([`#${t.randomText}_textCanvasContainer canvas{will-change:transform;top:0;left:0;position:absolute;}`,`#${t.randomText}_textCanvasContainer.moving canvas{transition:transform 500s linear;}`,`#${t.randomText}_textCanvasContainer{will-change:transform;pointer-events:none;overflow:hidden;}`]),this.container=t.textCanvasContainer=document.createElement("div"),this.container.classList.add(`${t.randomText}_fullfill`),this.container.id=`${t.randomText}_textCanvasContainer`,t.container.appendChild(this.container))}_toggle(t){let e=this.dText,n=e.frame.time;this.container.classList[t?"add":"remove"]("moving");for(let i,a=e.DanmakuText.length;a--;)(i=e.DanmakuText[a]).danmaku.mode>=2||(t?requestAnimationFrame(t=>this._move(i,n+5e5)):this._move(i,n))}pause(){this._toggle(!1)}start(){this._toggle(!0)}_move(t,e){t.danmaku&&(void 0===e&&(e=this.dText.frame.time+5e5),t._cache.style.transform=`translate3d(${(10*(this.dText._calcSideDanmakuPosition(t,e,this.dText.width)-t.estimatePadding)|0)/10}px,${t.style.y-t.estimatePadding}px,0)`)}resetPos(){this.pause(),this.dText.paused||setImmediate(()=>this.start())}resize(){this.resetPos()}remove(t){this.container.removeChild(t._cache)}enable(){this.dText.DanmakuText.forEach(t=>{this.newDanmaku(t)}),this.container.hidden=!1}disable(){this.container.hidden=!0,this.container.innerHTML=""}newDanmaku(t){t._cache.style.transform=`translate3d(${t.style.x-t.estimatePadding}px,${t.style.y-t.estimatePadding}px,0)`,this.container.appendChild(t._cache),t.danmaku.mode<2&&!this.dText.paused&&requestAnimationFrame(()=>this._move(t))}}n.default=o},{"./textModuleTemplate.js":10}],10:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class i{constructor(t){this.dText=t}draw(){}pause(){}start(){}clear(){}resize(){}remove(){}enable(){}disable(){}newDanmaku(){}deleteTextObject(){}}n.default=i},{}],11:[function(t,e,n){function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(t){if(d===setTimeout)return setTimeout(t,0);if((d===i||!d)&&setTimeout)return d=setTimeout,setTimeout(t,0);try{return d(t,0)}catch(e){try{return d.call(null,t,0)}catch(e){return d.call(this,t,0)}}}function s(t){if(h===clearTimeout)return clearTimeout(t);if((h===a||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function r(){g&&m&&(g=!1,m.length?p=m.concat(p):_=-1,p.length&&l())}function l(){if(!g){var t=o(r);g=!0;for(var e=p.length;e;){for(m=p,p=[];++_<e;)m&&m[_].run();_=-1,e=p.length}m=null,g=!1,s(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var d,h,f=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:i}catch(t){d=i}try{h="function"==typeof clearTimeout?clearTimeout:a}catch(t){h=a}}();var m,p=[],g=!1,_=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new u(t,e)),1!==p.length||g||o(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],12:[function(t,e,n){"use strict";var i=t("./i18n.js"),a=t("../lib/Object2HTML/Object2HTML.js"),o=function(t){return t&&t.__esModule?t:{default:t}}(a),s=t("./NyaPCore.js");const r=i.i18n._,l={autoHideDanmakuInput:!0,danmakuColors:["fff","6cf","ff0","f00","0f0","00f","f0f","000"],danmakuModes:[0,3,2,1],defaultDanmakuColor:null,defaultDanmakuMode:0,danmakuSend:(t,e)=>{e(!1)},danmakuSizes:[20,24,36],defaultDanmakuSize:24};class u extends s.NyaPlayerCore{constructor(t){function e(t,e,n={}){const i=u[t];return(0,o.default)({_:"span",event:e,attr:n,prop:{id:`icon_span_${t}`,innerHTML:`<svg height=${i[1]} width=${i[0]} id="icon_${t}"">${i[2]}</svg>`}})}super(Object.assign({},l,t)),t=this.opt;const n=this,i=this.$,a=this.video;this._.playerMode="normal",a.controls=!1;const u={play:[30,30,'<path d="m10.063,8.856l9.873,6.143l-9.873,6.143v-12.287z" stroke-width="3" stroke-linejoin="round"/>'],addDanmaku:[30,30,'<path style="fill-opacity:0!important;" stroke-width="1.4" d="m21.004,8.995c-0.513,-0.513 -1.135,-0.770 -1.864,-0.770l-8.281,0c-0.729,0 -1.350,0.256 -1.864,0.770c-0.513,0.513 -0.770,1.135 -0.770,1.864l0,8.281c0,0.721 0.256,1.341 0.770,1.858c0.513,0.517 1.135,0.776 1.864,0.776l8.281,0c0.729,0 1.350,-0.258 1.864,-0.776c0.513,-0.517 0.770,-1.136 0.770,-1.858l0,-8.281c0,-0.729 -0.257,-1.350 -0.770,-1.864z" stroke-linejoin="round"/><path d="m12.142,14.031l1.888,0l0,-1.888l1.937,0l0,1.888l1.888,0l0,1.937l-1.888,0l0,1.888l-1.937,0l0,-1.888l-1.888,0l0,-1.937z" stroke-width="1"/>'],danmakuToggle:[30,30,'<path d="m8.569,10.455l0,0c0,-0.767 0.659,-1.389 1.473,-1.389l0.669,0l0,0l3.215,0l6.028,0c0.390,0 0.765,0.146 1.041,0.406c0.276,0.260 0.431,0.613 0.431,0.982l0,3.473l0,0l0,2.083l0,0c0,0.767 -0.659,1.389 -1.473,1.389l-6.028,0l-4.200,3.532l0.985,-3.532l-0.669,0c-0.813,0 -1.473,-0.621 -1.473,-1.389l0,0l0,-2.083l0,0l0,-3.473z"/>'],danmakuStyle:[30,30,'<path style="fill-opacity:1!important" d="m21.781,9.872l-1.500,-1.530c-0.378,-0.385 -0.997,-0.391 -1.384,-0.012l-0.959,0.941l2.870,2.926l0.960,-0.940c0.385,-0.379 0.392,-0.998 0.013,-1.383zm-12.134,7.532l2.871,2.926l7.593,-7.448l-2.872,-2.927l-7.591,7.449l0.000,0.000zm-1.158,2.571l-0.549,1.974l1.984,-0.511l1.843,-0.474l-2.769,-2.824l-0.509,1.835z" stroke-width="0"/>'],fullPage:[30,30,'<path stroke-linejoin="round" d="m11.166,9.761l-5.237,5.239l5.237,5.238l1.905,-1.905l-3.333,-3.333l3.332,-3.333l-1.904,-1.906zm7.665,0l-1.903,1.905l3.332,3.333l-3.332,3.332l1.903,1.905l5.238,-5.238l-5.238,-5.237z" stroke-width="1.3" />'],fullScreen:[30,30,'<rect stroke-linejoin="round" height="11.169" width="17.655" y="9.415" x="6.172" stroke-width="1.5"/><path stroke-linejoin="round" d="m12.361,11.394l-3.604,3.605l3.605,3.605l1.311,-1.311l-2.294,-2.294l2.293,-2.294l-1.311,-1.311zm5.275,0l-1.310,1.311l2.293,2.294l-2.293,2.293l1.310,1.311l3.605,-3.605l-3.605,-3.605z"/>'],loop:[30,30,'<path stroke-linejoin="round" stroke-width="1" d="m20.945,15.282c-0.204,-0.245 -0.504,-0.387 -0.823,-0.387c-0.583,0 -1.079,0.398 -1.205,0.969c-0.400,1.799 -2.027,3.106 -3.870,3.106c-2.188,0 -3.969,-1.780 -3.969,-3.969c0,-2.189 1.781,-3.969 3.969,-3.969c0.720,0 1.412,0.192 2.024,0.561l-0.334,0.338c-0.098,0.100 -0.127,0.250 -0.073,0.380c0.055,0.130 0.183,0.213 0.324,0.212l2.176,0.001c0.255,-0.002 0.467,-0.231 0.466,-0.482l-0.008,-2.183c-0.000,-0.144 -0.085,-0.272 -0.217,-0.325c-0.131,-0.052 -0.280,-0.022 -0.379,0.077l-0.329,0.334c-1.058,-0.765 -2.340,-1.182 -3.649,-1.182c-3.438,0 -6.236,2.797 -6.236,6.236c0,3.438 2.797,6.236 6.236,6.236c2.993,0 5.569,-2.133 6.126,-5.072c0.059,-0.314 -0.022,-0.635 -0.227,-0.882z"/>'],volume:[30,30,'<ellipse id="volume_circle" style="fill-opacity:.6!important" ry="6" rx="6" cy="15" cx="15" stroke-dasharray="38 90" stroke-width="1.8"/>'],danmakuMode0:[30,30,'<path style="fill-opacity:1!important" stroke-width="0" d="m14.981,17.821l-7.937,-2.821l7.937,-2.821l0,1.409l7.975,0l0,2.821l-7.975,0l0,1.409l0,0.002z"/>'],danmakuMode1:[30,30,'<path style="fill-opacity:1!important" stroke-width="0" d="m15.019,12.178l7.937,2.821l-7.937,2.821l0,-1.409l-7.975,0l0,-2.821l7.975,0l0,-1.409l0,-0.002z"/>'],danmakuMode3:[30,30,'<path stroke-width="3" d="m7.972,7.486l14.054,0"/>'],danmakuMode2:[30,30,'<path stroke-width="3" d="m7.972,22.513l14.054,0"/>'],settings:[30,30,'<path stroke="null" style="fill-opacity:1!important" d="m19.770,13.364l-0.223,-0.530c0.766,-1.732 0.715,-1.784 0.566,-1.934l-0.979,-0.956l-0.097,-0.081l-0.113,0c-0.059,0 -0.238,0 -1.727,0.675l-0.547,-0.220c-0.708,-1.755 -0.780,-1.755 -0.988,-1.755l-1.381,0c-0.207,0 -0.287,-0.000 -0.944,1.761l-0.545,0.221c-1.006,-0.424 -1.596,-0.639 -1.755,-0.639l-0.130,0.004l-1.053,1.032c-0.159,0.150 -0.215,0.203 0.594,1.909l-0.223,0.528c-1.793,0.693 -1.793,0.760 -1.793,0.972l0,1.354c0,0.212 0,0.287 1.799,0.932l0.223,0.528c-0.766,1.731 -0.714,1.783 -0.566,1.932l0.979,0.958l0.097,0.083l0.114,0c0.058,0 0.235,0 1.726,-0.676l0.547,0.222c0.708,1.755 0.780,1.754 0.988,1.754l1.381,0c0.211,0 0.286,0 0.945,-1.760l0.548,-0.221c1.004,0.424 1.593,0.640 1.751,0.640l0.131,-0.003l1.061,-1.039c0.151,-0.152 0.204,-0.204 -0.602,-1.903l0.221,-0.529c1.795,-0.694 1.795,-0.766 1.795,-0.974l0,-1.353c-0.000,-0.213 -0.000,-0.287 -1.801,-0.929zm-4.770,3.888c-1.266,0 -2.298,-1.011 -2.298,-2.254c0,-1.241 1.031,-2.252 2.298,-2.252c1.266,0 2.295,1.010 2.295,2.252c-0.000,1.242 -1.029,2.254 -2.295,2.254z"/>']};this.loadingInfo(r("Creating player")),this._.player=(0,o.default)({_:"div",attr:{class:"NyaP",id:"NyaP",tabindex:0},child:[this.videoFrame,{_:"div",attr:{id:"controls"},child:[{_:"div",attr:{id:"control"},child:[{_:"span",attr:{id:"control_left"},child:[e("play",{click:t=>this.playToggle()},{title:r("play")})]},{_:"span",attr:{id:"control_center"},child:[{_:"div",prop:{id:"progress_info"},child:[{_:"span",child:[{_:"canvas",prop:{id:"progress",pad:10}}]},{_:"span",prop:{id:"time_frame"},child:[{_:"span",prop:{id:"time"},child:[{_:"span",prop:{id:"current_time"},child:["00:00"]},"/",{_:"span",prop:{id:"total_time"},child:["00:00"]}]}]}]},{_:"div",prop:{id:"danmaku_input_frame"},child:[{_:"span",prop:{id:"danmaku_style"},child:[{_:"div",attr:{id:"danmaku_style_pannel"},child:[{_:"div",attr:{id:"danmaku_color_box"}},{_:"input",attr:{id:"danmaku_color",placeholder:r("hex color"),maxlength:"6"}},{_:"span",attr:{id:"danmaku_mode_box"}},{_:"span",attr:{id:"danmaku_size_box"}}]},e("danmakuStyle")]},{_:"input",attr:{id:"danmaku_input",placeholder:r("Input danmaku here")}},{_:"span",prop:{id:"danmaku_submit",innerHTML:r("Send")}}]}]},{_:"span",attr:{id:"control_right"},child:[e("addDanmaku",{click:t=>this.danmakuInput()},{title:r("danmaku input(Enter)")}),e("danmakuToggle",{click:t=>this.danmakuToggle()},{title:r("danmaku toggle(D)")}),e("volume",{},{title:r("volume($0)([shift]+↑↓)","100%")}),e("loop",{click:t=>{a.loop=!a.loop}},{title:r("loop(L)")}),{_:"span",prop:{id:"player_mode"},child:[e("fullPage",{click:t=>this.playerMode("fullPage")},{title:r("full page(P)")}),e("fullScreen",{click:t=>this.playerMode("fullScreen")},{title:r("full screen(F)")})]}]}]}]}]}),this.videoFrame.appendChild((0,o.default)({_:"div",attr:{id:"msg_box"}})),this.collectEles(this._.player),t.danmakuSizes&&t.danmakuSizes.forEach((t,e)=>{let n=(0,o.default)({_:"span",attr:{style:`font-size:${12+3*e}px;`,title:t},prop:{size:t},child:["A"]});i.danmaku_size_box.appendChild(n)}),t.danmakuColors&&t.danmakuColors.forEach(t=>{let e=(0,o.default)({_:"span",attr:{style:`background-color:#${t};`,title:t},prop:{color:t}});i.danmaku_color_box.appendChild(e)}),t.danmakuModes&&t.danmakuModes.forEach(t=>{i.danmaku_mode_box.appendChild(e(`danmakuMode${t}`))}),this.collectEles(i.danmaku_mode_box),setTimeout(()=>{i.control.ResizeSensor=new s.ResizeSensor(i.control,()=>this.refreshProgress());this.refreshProgress()},0),this._.progressContext=i.progress.getContext("2d");const c={NyaP:{keydown:t=>this._playerKeyHandle(t)},document:{"fullscreenchange,mozfullscreenchange,webkitfullscreenchange,msfullscreenchange":t=>{"fullScreen"!=this._.playerMode||(0,s.isFullscreen)()||this.playerMode("normal")}},main_video:{playing:t=>this._iconActive("play",!0),"pause,stalled":t=>{this._iconActive("play",!1)},timeupdate:t=>{if(Date.now()-this._.lastTimeUpdate<30)return;this._setTimeInfo((0,s.formatTime)(a.currentTime,a.duration));this.drawProgress();this._.lastTimeUpdate=Date.now()},loadedmetadata:t=>{this._setTimeInfo(null,(0,s.formatTime)(a.duration,a.duration))},volumechange:t=>{(0,s.setAttrs)(i.volume_circle,{"stroke-dasharray":`${12*a.volume*Math.PI} 90`,style:`fill-opacity:${a.muted?.2:.6}!important`});i.icon_span_volume.setAttribute("title",r("volume($0)([shift]+↑↓)",a.muted?r("muted"):`${100*a.volume|0}%`))},progress:t=>this.drawProgress(),_loopChange:t=>this._iconActive("loop",t.value),click:t=>this.playToggle(),contextmenu:t=>t.preventDefault()},progress:{"mousemove,click":t=>{let e=t.target,n=(0,s.limitIn)((t.offsetX-e.pad)/(e.offsetWidth-2*e.pad),0,1);"mousemove"===t.type?(this._.progressX=t.offsetX,this.drawProgress(),this._setTimeInfo(null,(0,s.formatTime)(n*a.duration,a.duration))):"click"===t.type&&(a.currentTime=n*a.duration)},mouseout:t=>{this._.progressX=void 0;this.drawProgress();this._setTimeInfo(null,(0,s.formatTime)(a.duration,a.duration))}},danmaku_style_pannel:{click:t=>setImmediate(t=>this.$.danmaku_input.focus())},danmaku_color:{"input,change":t=>{let e,n=t.target;(e=n.value.match(/^([\da-f\$]{3}){1,2}$/i))?(e=e[0],n.style.backgroundColor=`#${e}`,this._.danmakuColor=e):(this._.danmakuColor=void 0,n.style.backgroundColor="")}},icon_span_volume:{click:t=>a.muted=!a.muted,wheel:t=>{t.preventDefault();if(0!==t.deltaMode)return;let e;e=t.shiftKey?t.deltaY>0?10:-10:t.deltaY>10||t.deltaY<-10?t.deltaY/10:t.deltaY;a.volume=(0,s.limitIn)(a.volume+e/100,0,1)}},danmakuModeSwitch:{click:function(){let t=1*this.id.match(/\d$/)[0];void 0!==n._.danmakuMode&&i[`icon_span_danmakuMode${n._.danmakuMode}`].classList.remove("active"),i[`icon_span_danmakuMode${t}`].classList.add("active"),n._.danmakuMode=t}},danmaku_input:{keydown:t=>{"Enter"===t.key?this.send():"Escape"===t.key&&this.danmakuInput(!1)}},danmaku_submit:{click:t=>this.send()},danmaku_size_box:{click:t=>{let e=t.target;if(!e.size)return;(0,s.toArray)(i.danmaku_size_box.childNodes).forEach(t=>{this._.danmakuSize===t.size&&t.classList.remove("active")});e.classList.add("active");this._.danmakuSize=e.size}},danmaku_color_box:{click:t=>{t.target.color&&(i.danmaku_color.value=t.target.color,i.danmaku_color.dispatchEvent(new Event("change")))}}};for(let t in i){let e=c[t];t.startsWith("icon_span_danmakuMode")&&(e=c.danmakuModeSwitch),e&&(0,s.addEvents)(i[t],e)}Number.isInteger(t.defaultDanmakuMode)&&i["icon_span_danmakuMode"+t.defaultDanmakuMode].click(),"number"==typeof t.defaultDanmakuSize&&(0,s.toArray)(i.danmaku_size_box.childNodes).forEach(e=>{e.size===t.defaultDanmakuSize&&e.click()}),this.on("danmakuToggle",t=>this._iconActive("danmakuToggle",t)),this.danmakuFrame.modules.TextDanmaku.enabled&&this._iconActive("danmakuToggle",!0)}_iconActive(t,e){this.$[`icon_span_${t}`].classList[e?"add":"remove"]("active_icon")}_setTimeInfo(t=null,e=null){requestAnimationFrame(()=>{null!==t&&(this.$.current_time.innerHTML=t);null!==e&&(this.$.total_time.innerHTML=e)})}_playerKeyHandle(t){if("INPUT"!==t.target.tagName){const e=this.video,n=t.shiftKey,i=t.repeat;switch(t.key){case" ":if(i)return;this.playToggle();break;case"ArrowRight":e.currentTime+=3*(n?2:1);break;case"ArrowLeft":e.currentTime-=1.5*(n?2:1);break;case"ArrowUp":e.volume=(0,s.limitIn)(e.volume+.03*(n?2:1),0,1);break;case"ArrowDown":e.volume=(0,s.limitIn)(e.volume-.03*(n?2:1),0,1);break;case"p":if(i)return;this.playerMode("fullPage");break;case"f":this.playerMode("fullScreen");break;case"d":if(i)return;this.danmakuToggle();break;case"m":if(i)return;this.video.muted=!this.video.muted;break;case"l":this.video.loop=!this.video.loop;break;case"Enter":if(i)return;this.danmakuInput();break;case"Escape":if("fullPage"===this._.playerMode){this.playerMode("normal");break}return;default:return}t.preventDefault()}}danmakuInput(t=!this.$.danmaku_input_frame.offsetHeight){let e=this.$;e.danmaku_input_frame.style.display=t?"flex":"",this._iconActive("addDanmaku",t),setImmediate(()=>{t?e.danmaku_input.focus():e.NyaP.focus()})}playerMode(t="normal"){if("normal"!==t||this._.playerMode!==t){this.$;switch("fullPage"===this._.playerMode?(this.player.style.position="",this._iconActive("fullPage",!1)):"fullScreen"===this._.playerMode&&(this._iconActive("fullScreen",!1),(0,s.exitFullscreen)()),"normal"!==t&&this._.playerMode===t&&(t="normal"),t){case"fullPage":this.player.style.position="fixed",this._iconActive("fullPage",!0),this.player.setAttribute("playerMode","fullPage");break;case"fullScreen":this._iconActive("fullScreen",!0),this.player.setAttribute("playerMode","fullScreen"),(0,s.requestFullscreen)(this.player);break;default:this.player.setAttribute("playerMode","normal")}this._.playerMode=t,this.emit("playerModeChange",t)}}refreshProgress(){const t=this.$.progress;t.width=t.offsetWidth,t.height=t.offsetHeight,this.drawProgress(),this.emit("progressRefresh")}send(){let t=this._.danmakuColor||this.opt.defaultDanmakuColor,e=this.$.danmaku_input.value,n=this._.danmakuSize,i=this._.danmakuMode,a=this.danmakuFrame.time;if(e.match(/^\s*$/))return void this.danmakuInput(!1);t&&(t=t.replace(/\$/g,()=>"0123456789abcdef"[(0,s.limitIn)(16*Math.random()|0,0,15)]));let o={color:t,text:e,size:n,mode:i,time:a};this.opt.danmakuSend&&this.opt.danmakuSend(o,t=>{t&&"text"===t._&&(this.$.danmaku_input.value="");let e=this.danmakuFrame.modules.TextDanmaku.load(t);e.highlight=!0;this.opt.autoHideDanmakuInput&&this.danmakuInput(!1)})}_progressDrawer(){const t=this._.progressContext,e=this.$.progress,n=e.width,i=e.height,a=this.video,o=a.duration,r=a.currentTime,l=e.pad,u=n-2*l;let c;t.clearRect(0,0,n,i),t.lineCap="round",t.beginPath(),t.strokeStyle="#eee",t.lineWidth=7,t.moveTo(l,15),t.lineTo(l+u,15),t.stroke(),t.beginPath(),t.strokeStyle="#C0BBBB",t.lineWidth=2;let d=a.buffered;for(c=d.length;c--;)t.moveTo(l+d.start(c)/o*u,18),t.lineTo(l+d.end(c)/o*u,18);for(t.stroke(),t.beginPath(),t.strokeStyle="#6cf",t.lineWidth=5,t.moveTo(l,15),t.lineTo(l+u*r/o,15),t.stroke(),t.beginPath(),t.strokeStyle="rgba(255,255,255,.3)",t.lineWidth=5,d=a.played,c=d.length;c--;)t.moveTo(l+d.start(c)/o*u,15),t.lineTo(l+d.end(c)/o*u,15);t.stroke(),this._.progressX&&(t.beginPath(),t.strokeStyle="rgba(0,0,0,.05)",t.moveTo(l+u*r/o,15),t.lineTo((0,s.limitIn)(this._.progressX,l,l+u),15),t.stroke()),this._.drawingProgress=!1}drawProgress(){this._.drawingProgress||(this._.drawingProgress=!0,requestAnimationFrame(()=>{this._progressDrawer()}))}msg(t,e="tip"){let n=new c(t,e);this.$.msg_box.appendChild(n.msg),n.show()}}class c{constructor(t,e){this.using=!1,(this.msg=(0,o.default)({_:"div",attr:{class:`msg_type_${e}`},child:[t]})).addEventListener("click",()=>this.remove()),t instanceof HTMLElement&&(t=t.textContent);let n=String(t).match(/\w+|\S/g);this.timeout=setTimeout(()=>this.remove(),Math.max(.6*(n?n.length:0)*1e3,5e3))}show(){this.msg.style.opacity=0,setTimeout(()=>{this.using=!0;this.msg.style.opacity=1},0)}remove(){this.using&&(this.using=!1,this.msg.style.opacity=0,this.timeout&&(clearTimeout(this.timeout),this.timeout=0),setTimeout(()=>{this.msg.parentNode.removeChild(this.msg)},300))}}window.NyaP=u},{"../lib/Object2HTML/Object2HTML.js":1,"./NyaPCore.js":13,"./i18n.js":14}],13:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){Array.isArray(t)||(t=[t]);for(let n in e)n.split(/\,/g).forEach(function(i){t.forEach(function(t){t.addEventListener(i,e[n])})})}function o(t){try{(t.requestFullscreen||t.msRequestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullscreen).call(t)}catch(t){console.error(t),alert(v("Failed to change to fullscreen mode"))}}function s(){const t=document;(t.exitFullscreen||t.msExitFullscreen||t.mozCancelFullScreen||t.webkitCancelFullScreen).call(t)}function r(){const t=document;return!!(t.fullscreen||t.mozFullScreen||t.webkitIsFullScreen||t.msFullscreenElement)}function l(t,e){let n,i=0|t,a=i/3600|0;return e>=3600&&(i%=3600),n=[u(i/60|0),u(i%60)],e>=3600&&n.unshift(a),n.join(":")}function u(t){return t>9&&t||`0${t}`}function c(t,e){for(let n in e)t.setAttribute(n,e[n])}function d(t,e,n){return t<e?e:t>n?n:t}function h(t,e){return t+Math.random()*(e-t)+.5|0}function f(t){return[...t]}Object.defineProperty(n,"__esModule",{value:!0}),n.ResizeSensor=n.toArray=n.limitIn=n.setAttrs=n.padTime=n.rand=n.formatTime=n.isFullscreen=n.exitFullscreen=n.requestFullscreen=n.addEvents=n.NyaPlayerCore=void 0;var m=t("./i18n.js"),p=t("../lib/danmaku-frame/src/danmaku-frame.js"),g=t("../lib/danmaku-text/src/danmaku-text.js"),_=i(g),k=t("../lib/Object2HTML/Object2HTML.js"),y=i(k);const v=m.i18n._;(0,_.default)(p.DanmakuFrame,p.DanmakuFrameModule);const x={muted:!1,volume:1,loop:!1,textStyle:{},danmakuOption:{}};class T{constructor(){this._events={}}emit(t,e){this._resolve(t,e),this.globalHandle(t,e)}_resolve(t,e){if(t in this._events){const n=this._events[t];try{n.forEach(t=>{t.call(this,e)})}catch(t){console.error(t)}}}on(t,e){e instanceof Function&&(t in this._events||(this._events[t]=[]),this._events[t].push(e))}removeEvent(t,e){if(t in this._events){if(1===arguments.length)return void delete this._events[t];let n;(n=this._events[t].indexOf(e)>=0)&&this._events[t].splice(n,1),0===this._events[t].length&&delete this._events[t]}}globalHandle(t,e){}}class w extends T{constructor(t){super(),t=this.opt=Object.assign({},x,t);const e=this.$={document:document,window:window};this._={};const n=this._.video=(0,y.default)({_:"video",attr:{id:"main_video"}});this.container=(0,y.default)({_:"div",prop:{id:"danmaku_container"}}),this.videoFrame=(0,y.default)({_:"div",attr:{id:"video_frame"},child:[n,this.container,{_:"div",attr:{id:"loading_frame"},child:[{_:"div",attr:{id:"loading_anime"},child:["(๑•́ ω •̀๑)"]},{_:"div",attr:{id:"loading_info"}}]}]}),this.collectEles(this.videoFrame),this.loadingInfo(v("Loading danmaku frame")),this.danmakuFrame=new p.DanmakuFrame(this.container),this.danmakuFrame.setMedia(n),this.danmakuFrame.enable("TextDanmaku"),this.setDanmakuOptions(t.danmakuOption),this.setDanmakuOptions(t.textStyle),this.danmakuFrame.addStyle(["#loading_frame{top:0;left:0;width:100%;height:100%;position:absolute;background-color:#efefef;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;cursor:dafault;}","#loading_frame #loading_anime{display:inline-block;font-size:5em;transition:transform 0.08s linear;will-change:transfrom;pointer-events:none;}","#loading_frame #loading_info{display:block;font-size:.9em;position:absolute;left:0;bottom:0;padding:0.4em;color:#868686;}"]),this._.loadingAnimeInterval=setInterval(()=>{e.loading_anime.style.transform="translate("+h(-20,20)+"px,"+h(-20,20)+"px) rotate("+h(-10,10)+"deg)"},80),setTimeout(e=>{["src","muted","volume","loop"].forEach(e=>{void 0!==t[e]&&(this.video[e]=t[e])})},0);{let t=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"loop");Object.defineProperty(n,"loop",{get:t.get,set:function(e){e!==this.loop&&(this.dispatchEvent(Object.assign(new Event("_loopChange"),{value:e})),t.set.call(this,e))}})}a(n,{loadedmetadata:t=>{clearInterval(this._.loadingAnimeInterval);e.loading_frame.parentNode.removeChild(e.loading_frame)},error:t=>{clearInterval(this._.loadingAnimeInterval);loading_anime.style.transform="";loading_anime.innerHTML="(๑• . •๑)"}}),this.emit("coreLoad")}playToggle(t=this.video.paused){this.video[t?"play":"pause"]()}loadDanmaku(t){this.danmakuFrame.load(t)}loadDanmakuList(t){this.danmakuFrame.loadList(t)}removeDanmaku(t){this.danmakuFrame.unload(t)}danmakuToggle(t=!this.danmakuFrame.modules.TextDanmaku.enabled){this.danmakuFrame[t?"enable":"disable"]("TextDanmaku"),this.emit("danmakuToggle",t)}danmakuAt(t,e){return this.danmakuFrame.modules.TextDanmaku.danmakuAt(t,e)}loadingInfo(t){this.$.loading_info.appendChild((0,y.default)({_:"div",child:[t]}))}collectEles(t){const e=this.$;t.id&&!e[t.id]&&(e[t.id]=t),f(t.querySelectorAll("*")).forEach(t=>{t.id&&!e[t.id]&&(e[t.id]=t)})}get player(){return this._.player}get video(){return this._.video}get src(){return this.video.src}set src(t){this.video.src=t}get TextDanmaku(){return this.danmakuFrame.modules.TextDanmaku}get videoSize(){return[this.video.videoWidth,this.video.videoHeight]}setDefaultTextStyle(t){if(t)for(let e in t)this.TextDanmaku.defaultStyle[e]=t[e]}setDanmakuOptions(t){if(t)for(let e in t)this.TextDanmaku.options[e]=t[e]}}String.prototype.startsWith||(String.prototype.startsWith=function(t,e=0){return this.substr(e,t.length)===t}),Object.assign||(Object.assign=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var a=arguments[i];if(null!=a)for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n}),n.default=w,n.NyaPlayerCore=w,n.addEvents=a,n.requestFullscreen=o,n.exitFullscreen=s,n.isFullscreen=r,n.formatTime=l,n.rand=h,n.padTime=u,n.setAttrs=c,n.limitIn=d,n.toArray=f,n.ResizeSensor=p.ResizeSensor},{"../lib/Object2HTML/Object2HTML.js":1,"../lib/danmaku-frame/src/danmaku-frame.js":3,"../lib/danmaku-text/src/danmaku-text.js":6,"./i18n.js":14}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i={lang:null,langs:{},_:(t,...e)=>{let n=i.lang&&i.langs[i.lang][t]||t;e.length&&e.forEach((t,e)=>{n=n.replace(`$${e}`,t)});return n}};i.langs["zh-CN"]={play:"播放",Send:"发送",pause:"暂停",muted:"静音",settings:"设置","loop(L)":"循环(L)","hex color":"Hex颜色","full page(P)":"全页模式(P)","Creating player":"创建播放器","full screen(F)":"全屏模式(F)","danmaku toggle(D)":"弹幕开关(D)","Input danmaku here":"在这里输入弹幕","Loading danmaku frame":"加载弹幕框架","danmaku input(Enter)":"弹幕输入框(回车)","volume($0)([shift]+↑↓)":"音量($0)([shift]+↑↓)","Failed to change to fullscreen mode":"无法切换到全屏模式"},navigator.languages||(navigator.languages=[navigator.language]);for(let t of[...navigator.languages]){if(i.langs[t]){i.lang=t;break}let e=t.match(/^\w+/)[0];for(let t in i.langs)if(t.startsWith(e)){i.lang=t;break}if(i.lang)break}console.debug("Language:"+i.lang),n.i18n=i},{}]},{},[12]);