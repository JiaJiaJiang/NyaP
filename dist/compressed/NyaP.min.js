!function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){var n=e[a][1][t];return o(n?n:t)},h,h.exports,t,e,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){"use strict";function i(t,e){var n=void 0,r=void 0,a=void 0;if("string"==typeof t)return document.createTextNode(t);if("_"in t!=!1&&"string"==typeof t._&&""!=t._){if(n=document.createElement(t._),"object"===o(t.attr))for(r in t.attr)n.setAttribute(r,t.attr[r]);if("object"===o(t.prop))for(r in t.prop)n[r]=t.prop[r];if("object"===o(t.event))for(r in t.event)n.addEventListener(r,t.event[r]);if("object"===o(t.child)&&t.child.length>0){var s=!0,l=!1,u=void 0;try{for(var h,c=t.child[Symbol.iterator]();!(s=(h=c.next()).done);s=!0)r=h.value,a=r instanceof Node?r:i(r,e),a instanceof Node&&n.appendChild(a)}catch(t){l=!0,u=t}finally{try{!s&&c.return&&c.return()}finally{if(l)throw u}}}return e&&e(n),n}}Object.defineProperty(n,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.Object2HTML=i},{}],2:[function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,o){"function"==typeof define&&define.amd?define(o):"object"===("undefined"==typeof n?"undefined":i(n))?e.exports=o():t.ResizeSensor=o()}(void 0,function(){function t(t,e){var n=Object.prototype.toString.call(t),i="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"[object Object]"===n||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,o=0,r=t.length;if(i)for(;o<r;o++)e(t[o]);else e(t)}if("undefined"==typeof window)return null;var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)},n=function n(i,o){function r(){var t=[];this.add=function(e){t.push(e)};var e,n;this.call=function(){for(e=0,n=t.length;e<n;e++)t[e].call()},this.remove=function(i){var o=[];for(e=0,n=t.length;e<n;e++)t[e]!==i&&o.push(t[e]);t=o},this.length=function(){return t.length}}function a(t,e){return t.currentStyle?t.currentStyle[e]:window.getComputedStyle?window.getComputedStyle(t,null).getPropertyValue(e):t.style[e]}function s(t,n){if(t.resizedAttached)return void t.resizedAttached.add(n);t.resizedAttached=new r,t.resizedAttached.add(n),t.resizeSensor=document.createElement("div"),t.resizeSensor.className="resize-sensor";var i="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",o="position: absolute; left: 0; top: 0; transition: 0s;";t.resizeSensor.style.cssText=i,t.resizeSensor.innerHTML='<div class="resize-sensor-expand" style="'+i+'"><div style="'+o+'"></div></div><div class="resize-sensor-shrink" style="'+i+'"><div style="'+o+' width: 200%; height: 200%"></div></div>',t.appendChild(t.resizeSensor),"static"==a(t,"position")&&(t.style.position="relative");var s,l,u,h,c=t.resizeSensor.childNodes[0],f=c.childNodes[0],d=t.resizeSensor.childNodes[1],v=t.offsetWidth,p=t.offsetHeight,m=function(){f.style.width="100000px",f.style.height="100000px",c.scrollLeft=1e5,c.scrollTop=1e5,d.scrollLeft=1e5,d.scrollTop=1e5};m();var y=function(){l=0,s&&(v=u,p=h,t.resizedAttached&&t.resizedAttached.call())},g=function(){u=t.offsetWidth,h=t.offsetHeight,s=u!=v||h!=p,s&&!l&&(l=e(y)),m()},w=function(t,e,n){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n)};w(c,"scroll",g),w(d,"scroll",g)}t(i,function(t){s(t,o)}),this.detach=function(t){n.detach(i,t)}};return n.detach=function(e,n){t(e,function(t){t.resizedAttached&&"function"==typeof n&&(t.resizedAttached.remove(n),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached)})},n})},{}],3:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.DanmakuFrameModule=n.DanmakuFrame=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("../lib/ResizeSensor.js"),s=i(a),l=function(){function t(e){var n=this;o(this,t),this.container=e||document.createElement("div"),this.container.id="danmaku_container",this.rate=1,this.timeBase=0,this.media=null,this.fps=30,this.working=!1,this.modules={};var i=!0,r=!1,a=void 0;try{for(var l,u=t.moduleList[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var h=l.value;this.initModule(h[0])}}catch(t){r=!0,a=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw a}}setTimeout(function(){n.container.ResizeSensor=new s.default(n.container,function(){n.resize()})},0)}return r(t,[{key:"enable",value:function(t){var e=this.modules[t];return e?(e.enabled=!0,e.enable&&e.enable(),!0):this.initModule(t)}},{key:"disable",value:function(t){var e=this.modules[t];return!!e&&(e.enabled=!1,e.disable&&e.disable(),!0)}},{key:"initModule",value:function(e){var n=t.moduleList.get(e);if(!n)throw"Module ["+e+"] does not exist.";var i=new n(this);if(i instanceof u==!1)throw"Constructor of "+e+" is not extended from DanmakuFrameModule";return i.enabled=!0,this.modules[e]=i,console.debug("Mod Inited: "+e),!0}},{key:"load",value:function(t){this.moduleFunction("load")}},{key:"loadList",value:function(t){this.moduleFunction("loadList",t)}},{key:"unload",value:function(t){this.moduleFunction("unload",t)}},{key:"start",value:function(){this.working=!0,this.moduleFunction("start"),this.draw()}},{key:"pause",value:function(){this.working=!1,this.moduleFunction("pause")}},{key:"stop",value:function(){this.working=!1,this.moduleFunction("stop")}},{key:"resize",value:function(){this.moduleFunction("resize")}},{key:"moduleFunction",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];for(var o in this.modules){var r;this.modules[o][t]&&(r=this.modules[o])[t].apply(r,n)}}},{key:"draw",value:function(){var t=this;this.working!==!1&&(0===this.fps?requestAnimationFrame(function(){t.draw()}):setTimeout(function(){t.draw()},1e3/this.fps),this.moduleFunction("draw"))}},{key:"setMedia",value:function(t){this.media=t}},{key:"time",set:function(t){this.media||(this.timeBase=Date.now()-t),this.moduleFunction("time",t)},get:function(){return this.media?1e6*this.media.currentTime:Date.now()-this.timeBase}}],[{key:"addModule",value:function(t,e){return this.moduleList.has(t)?void console.warn('The module "'+t+'" has already been added.'):void this.moduleList.set(t,e)}}]),t}();l.moduleList=new Map;var u=function t(e){o(this,t),this.frame=e,this.enabled=!1};n.DanmakuFrame=l,n.DanmakuFrameModule=u},{"../lib/ResizeSensor.js":2}],4:[function(t,e,n){"use strict";function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,i){"function"==typeof define&&define.amd?define(i):"object"===("undefined"==typeof n?"undefined":l(n))?e.exports=i():t.CanvasObjLibrary=i()}(void 0,function(){function t(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var n in e)t.addEventListener(n,e[n])}function e(t,e,n){n[0]=t[0]*e[0]+t[1]*e[3],n[1]=t[0]*e[1]+t[1]*e[4],n[2]=t[0]*e[2]+t[1]*e[5]+t[2],n[3]=t[3]*e[0]+t[4]*e[3],n[4]=t[3]*e[1]+t[4]*e[4],n[5]=t[3]*e[2]+t[4]*e[5]+t[5]}var n=function(){function n(e){var i=this;if(r(this,n),e instanceof HTMLCanvasElement==!1)throw new TypeError("canvas required");Object.assign(this,{canvas:e,context:e.getContext("2d"),default:{font:{fontStyle:null,fontWeight:null,fontVariant:null,color:"#000",lineHeight:null,fontSize:14,fontFamily:"Arial",strokeWidth:0,strokeColor:"#000",shadowBlur:0,shadowColor:"#000",shadowOffsetX:0,shadowOffsetY:0,fill:!0,reverse:!1},style:{width:1,height:1,hidden:!1,opacity:1,clipOverflow:!1,backgroundColor:null,composite:null,debugBorderColor:"black",x:0,y:0,zoomX:1,zoomY:1,rotate:0,rotatePointX:0,rotatePointY:0,positionPointX:0,positionPointY:0,zoomPointX:0,zoomPointY:0,skewX:1,skewY:1,skewPointX:0,skewPointY:0}},stat:{mouse:{x:null,y:null,previousX:null,previousY:null},onfocus:null,onover:null,canvasOnFocus:!1,canvasOnover:!1},tmp:{graphID:0,onOverGraph:null,toClickGraph:null,matrix1:new Float32Array([1,0,0,0,1,0]),matrix2:new Float32Array([1,0,0,0,1,0]),matrix3:new Float32Array([1,0,0,0,1,0])},root:null,class:{},autoClear:!0,debug:{switch:!1,count:0,FPS:0,_lastFrameTime:Date.now(),_recordOffset:0,_timeRecorder:new Uint32Array(15),on:function(){this.switch=!0},off:function(){this.switch=!1}}});for(var o in l)this.class[o]=l[o](this);this.root=new this.class.FunctionGraph,this.root.name="root",Object.defineProperty(this.root,"parentNode",{configurable:!1}),this.adjustCanvas(),t(e,{mouseout:function(t){i.stat.canvasOnover=!1,i.stat.mouse.x=null,i.stat.mouse.y=null;i.stat.onover;i._commonEventHandle(t),i.stat.onover=null},mouseover:function(t){i.stat.canvasOnover=!0},mousemove:function(t){i.tmp.toClick=!1,i._commonEventHandle(t)},mousedown:function(t){i.tmp.toClickGraph=i.stat.onover,i.stat.canvasOnFocus=!0,i.stat.onfocus=i.stat.onover,i._commonEventHandle(t)},mouseup:function(t){return i._commonEventHandle(t)},click:function(t){i.tmp.toClickGraph&&i._commonEventHandle(t)},dblclick:function(t){return i._commonEventHandle(t)},selectstart:function(t){return t.preventDefault()},wheel:function(t){var e=new i.class.WheelEvent("wheel");e.originEvent=t,(i.stat.onover||i.root).emit(e)}}),t(document,{mousedown:function(t){t.target!==i.canvas&&(i.stat.canvasOnFocus=!1)},mouseout:function(t){if(null!==i.stat.mouse.x){var e=new window.MouseEvent("mouseout");i.canvas.dispatchEvent(e)}},keydown:function(t){return i._commonEventHandle(t)},keyup:function(t){return i._commonEventHandle(t)},keypress:function(t){return i._commonEventHandle(t)}})}return s(n,[{key:"generateGraphID",value:function(){return++this.tmp.graphID}},{key:"adjustCanvas",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.canvas.offsetWidth,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.canvas.offsetHeight;this.root.style.width=this.canvas.width=t,this.root.style.height=this.canvas.height=e;var n=new this.class.Event("resize");this.root.emit(n)}},{key:"_commonEventHandle",value:function(t){if(t instanceof MouseEvent){this.stat.previousX=this.stat.mouse.x,this.stat.previousY=this.stat.mouse.y,"mouseout"===t.type?(this.stat.mouse.x=null,this.stat.mouse.y=null):(this.stat.mouse.x=t.layerX,this.stat.mouse.y=t.layerY);var e=new this.class.MouseEvent(t.type);e.originEvent=t,(this.stat.onover||this.root).emit(e)}else if(t instanceof KeyboardEvent){if(!this.stat.canvasOnFocus)return;var n=new this.class.KeyboardEvent(t.type);n.originEvent=t,(this.stat.onfocus||this.root).emit(n)}}},{key:"clear",value:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"draw",value:function(){this.debug.count=0,this.autoClear&&this.clear(),this.traverseGraphTree(0),this.debug.switch&&this.drawDebug()}},{key:"traverseGraphTree",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.context.setTransform(1,0,0,1,0,0),this.drawGraph(this.root,t),this.tmp.onOverGraph!==this.stat.onover){var e=this.stat.onover;if(this.tmp.toClickGraph=null,this.stat.onover=this.tmp.onOverGraph,e){var n=new this.class.MouseEvent("mouseout");e.emit(n)}if(this.stat.onover){var i=new this.class.MouseEvent("mouseover");this.stat.onover.emit(i)}}this.tmp.onOverGraph=null}},{key:"drawDebug",value:function(){var t=this.context,e=this.debug,n=e._timeRecorder,i=Date.now();n[e._recordOffset++]=i-e._lastFrameTime,e._lastFrameTime=i,15===e._recordOffset&&(e._recordOffset=0),e.FPS=15e3/(n[0]+n[1]+n[2]+n[3]+n[4]+n[5]+n[6]+n[7]+n[8]+n[9]+n[10]+n[11]+n[12]+n[13]+n[14])+.5|0,t.save(),t.beginPath(),t.setTransform(1,0,0,1,0,0),t.font="16px Arial",t.textBaseline="bottom",t.globalCompositeOperation="lighter",t.fillStyle="red",t.fillText("point:"+String(this.stat.mouse.x)+","+String(this.stat.mouse.y)+" FPS:"+this.debug.FPS+" Items:"+this.debug.count,0,this.canvas.height),t.fillText("onover:"+(this.stat.onover?this.stat.onover.GID:"null")+" onfocus:"+(this.stat.onfocus?this.stat.onfocus.GID:"null"),0,this.canvas.height-20),t.strokeStyle="red",t.globalCompositeOperation="source-over",t.moveTo(this.stat.mouse.x,this.stat.mouse.y+6),t.lineTo(this.stat.mouse.x,this.stat.mouse.y-6),t.moveTo(this.stat.mouse.x-6,this.stat.mouse.y),t.lineTo(this.stat.mouse.x+6,this.stat.mouse.y),t.stroke(),t.restore()}},{key:"drawGraph",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t.style.hidden!==!0){var i=this.context,o=t.style,r=this.tmp.matrix3,a=this.tmp.matrix1,s=this.tmp.matrix2;if(this.debug.count++,i.save(),0===n&&(o.composite&&(i.globalCompositeOperation=o.composite),i.globalAlpha=o.opacity),a[0]=1,a[1]=0,a[2]=o.x-o.positionPointX,a[3]=0,a[4]=1,a[5]=o.y-o.positionPointY,1===o.skewX&&1===o.skewY||(0!==o.skewPointX||0!==o.skewPointY?(r[0]=1,r[1]=0,r[2]=o.skewPointX,r[3]=0,r[4]=1,r[5]=o.skewPointY,e(a,r,s),r[0]=o.skewX,r[2]=0,r[4]=o.skewY,r[5]=0,e(s,r,a),r[0]=1,r[2]=-o.skewPointX,r[4]=1,r[5]=-o.skewPointY,e(a,r,s)):(r[0]=o.skewX,r[1]=0,r[2]=0,r[3]=0,r[4]=o.skewY,r[5]=0,e(a,r,s)),a.set(s)),0!==o.rotate){var l=.0174532925*o.rotate;0!==o.rotatePointX||0!==o.rotatePointY?(r[0]=1,r[1]=0,r[2]=o.rotatePointX,r[3]=0,r[4]=1,r[5]=o.rotatePointY,e(a,r,s),r[0]=Math.cos(l),r[1]=-Math.sin(l),r[2]=0,r[3]=Math.sin(l),r[4]=Math.cos(l),r[5]=0,e(s,r,a),r[0]=1,r[1]=0,r[2]=-o.rotatePointX,r[3]=0,r[4]=1,r[5]=-o.rotatePointY,e(a,r,s)):(r[0]=Math.cos(l),r[1]=-Math.sin(l),r[2]=0,r[3]=Math.sin(l),r[4]=Math.cos(l),r[5]=0,e(a,r,s)),a.set(s)}switch(1===o.zoomX&&1===o.zoomY||(0!==o.zoomPointX||0!==o.zoomPointY?(r[0]=1,r[1]=0,r[2]=o.zoomPointX,r[3]=0,r[4]=1,r[5]=o.zoomPointY,e(a,r,s),r[0]=o.zoomX,r[2]=0,r[4]=o.zoomY,r[5]=0,e(s,r,a),r[0]=1,r[2]=-o.zoomPointX,r[4]=1,r[5]=-o.zoomPointY,e(a,r,s)):(r[0]=o.zoomX,r[1]=0,r[2]=0,r[3]=0,r[4]=o.zoomY,r[5]=0,e(a,r,s)),a.set(s)),i.transform(a[0],a[3],a[1],a[4],a[2],a[5]),this.debug.switch&&0===n&&(i.save(),i.beginPath(),i.globalAlpha=.5,i.globalCompositeOperation="source-over",i.strokeStyle=t.style.debugBorderColor,i.strokeWidth=1.5,i.strokeRect(0,0,o.width,o.height),i.strokeWidth=1,i.globalAlpha=1,i.strokeStyle="green",i.strokeRect(o.positionPointX-5,o.positionPointY-5,10,10),i.strokeStyle="blue",i.strokeRect(o.rotatePointX-4,o.rotatePointX-4,8,8),i.strokeStyle="olive",i.strokeRect(o.zoomPointX-3,o.zoomPointX-3,6,6),i.strokeStyle="#6cf",i.strokeRect(o.skewPointX-2,o.skewPointX-2,4,4),i.restore()),t.style.clipOverflow&&(i.beginPath(),i.rect(0,0,o.width,o.height),i.clip()),n){case 0:t.drawer&&t.drawer(i);break;case 1:t.checkIfOnOver(!0,n)}if(t.childNodes.length){var u=!0,h=!1,c=void 0;try{for(var f,d=t.childNodes[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var v=f.value;this.drawGraph(v,n)}}catch(t){h=!0,c=t}finally{try{!u&&d.return&&d.return()}finally{if(h)throw c}}}i.restore()}}}]),n}(),l={Event:function(t){return function t(e){r(this,t),this.type=e,this.timeStamp=Date.now()}},GraphEvent:function(t){return function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.propagation=!0,n.stoped=!1,n.target=null,n}return o(e,t),s(e,[{key:"stopPropagation",value:function(){this.propagation=!1}},{key:"stopImmediatePropagation",value:function(){this.stoped=!0}},{key:"altKey",get:function(){return this.originEvent.altKey}},{key:"ctrlKey",get:function(){return this.originEvent.ctrlKey}},{key:"metaKey",get:function(){return this.originEvent.metaKey}},{key:"shiftKey",get:function(){return this.originEvent.shiftKey}}]),e}(t.class.Event)},MouseEvent:function(t){return function(e){function n(t){return r(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t))}return o(n,e),s(n,[{key:"button",get:function(){return this.originEvent.button}},{key:"buttons",get:function(){return this.originEvent.buttons}},{key:"movementX",get:function(){return t.stat.mouse.x-t.stat.previousX}},{key:"movementY",get:function(){return t.stat.mouse.y-t.stat.previousY}}]),n}(t.class.GraphEvent)},WheelEvent:function(t){return function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),s(e,[{key:"deltaX",get:function(){return this.originEvent.deltaX}},{key:"deltaY",get:function(){return this.originEvent.deltaY}},{key:"deltaZ",get:function(){return this.originEvent.deltaZ}},{key:"deltaMode",get:function(){return this.originEvent.deltaMode}}]),e}(t.class.MouseEvent)},KeyboardEvent:function(t){return function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),s(e,[{key:"key",get:function(){return this.originEvent.key}},{key:"code",get:function(){return this.originEvent.code}},{key:"repeat",get:function(){return this.originEvent.repeat}},{key:"keyCode",get:function(){return this.originEvent.keyCode}},{key:"charCode",get:function(){return this.originEvent.charCode}},{key:"location",get:function(){return this.originEvent.location}}]),e}(t.class.GraphEvent)},GraphEventEmitter:function(t){return function(){function e(){r(this,e),this._events={}}return s(e,[{key:"emit",value:function(e){e instanceof t.class.Event!=!1&&(e.target=this,this._resolve(e))}},{key:"_resolve",value:function(t){if(t.type in this._events){var e=this._events[t.type];try{var n=!0,i=!1,o=void 0;try{for(var r,a=e[Symbol.iterator]();!(n=(r=a.next()).done);n=!0){var s=r.value;if(s.call(this,t),t.stoped)return}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}}catch(t){console.error(t)}}t.propagation===!0&&this.parentNode&&this.parentNode._resolve(t)}},{key:"on",value:function(t,e){e instanceof Function&&(t in this._events||(this._events[t]=[]),this._events[t].push(e))}},{key:"removeEvent",value:function(t,e){if(t in this._events){if(1===arguments.length)return void delete this._events[t];var n=void 0;(n=this._events[t].indexOf(e)>=0)&&this._events[t].splice(n,1),0===this._events[t].length&&delete this._events[t]}}}]),e}()},GraphStyle:function(t){return function(){function e(n){r(this,e),n&&this.inhert(n)||(this.__proto__.__proto__=t.default.style,this._calculatableStyleChanged=!1)}return s(e,[{key:"inhertGraph",value:function(e){if(!(e instanceof t.class.Graph))throw new TypeError("graph is not a Graph instance");return this.inhertStyle(e.style),!0}},{key:"inhertStyle",value:function(e){if(!(e instanceof t.class.GraphStyle))throw new TypeError("graph is not a Graph instance");return this.__proto__=e,!0}},{key:"inhert",value:function(e){return e instanceof t.class.Graph?(this.inhertGraph(e),!0):e instanceof t.class.GraphStyle&&(this.inhertStyle(e),!0)}},{key:"cancelInhert",value:function(){this.__proto__=Object.prototype}},{key:"getPoint",value:function(t){switch(t){case"center":return[this.width/2,this.height/2]}return[0,0]}},{key:"position",value:function(t,e){this.x=t,this.y=e}},{key:"zoom",value:function(t,e){1==arguments.length?this.zoomX=this.zoomY=t:(this.zoomX=t,this.zoomY=e)}},{key:"size",value:function(t,e){this.width=t,this.height=e}},{key:"setRotatePoint",value:function(t,e){if(2==arguments.length)this.rotatePointX=t,this.rotatePointY=e;else if(1==arguments.length){var n=this.getPoint(t),i=a(n,2);this.rotatePointX=i[0],this.rotatePointY=i[1]}}},{key:"setPositionPoint",value:function(t,e){if(2==arguments.length)this.positionPointX=t,this.positionPointY=e;else if(1==arguments.length){var n=this.getPoint(t),i=a(n,2);this.positionPointX=i[0],this.positionPointY=i[1]}}},{key:"setZoomPoint",value:function(t,e){if(2==arguments.length)this.zoomPointX=t,this.zoomPointY=e;else if(1==arguments.length){var n=this.getPoint(t),i=a(n,2);this.zoomPointX=i[0],this.zoomPointY=i[1]}}},{key:"setSkewPoint",value:function(t,e){if(2==arguments.length)this.skewPointX=t,this.skewPointY=e;else if(1==arguments.length){var n=this.getPoint(t),i=a(n,2);this.skewPointX=i[0],this.skewPointY=i[1]}}}]),e}()},Graph:function(t){return function(e){function n(){r(this,n);var e=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.host=t,e.GID=e.host.generateGraphID(),e.onoverCheck=!0,Object.defineProperties(e,{style:{value:new t.class.GraphStyle,configurable:!0},childNodes:{value:[]},parentNode:{value:void 0,configurable:!0}}),e}return o(n,e),s(n,[{key:"createShadow",value:function(){var e=Object.create(this);return e.GID=this.host.generateGraphID(),e.shadowParent=this,Object.defineProperties(e,{style:{value:new t.class.GraphStyle(this.style),configurable:!0},parentNode:{value:void 0,configurable:!0}}),e}},{key:"appendChild",value:function(e){if(!(e instanceof t.class.Graph))throw new TypeError("graph is not a Graph instance");if(e===this)throw new Error("can not add myself as a child");if(e.parentNode!==this)Object.defineProperty(e,"parentNode",{value:this});else{var n=this.findChild(e);n>=0&&this.childNodes.splice(n,1)}this.childNodes.push(e)}},{key:"insertAfter",value:function(e){if(!(e instanceof t.class.Graph))throw new TypeError("graph is not a Graph instance");if(e===this)throw new Error("can not add myself as a child");var n=e.parentNode,i=void 0,o=void 0;if(!n)throw new Error("no parentNode");o=n.findChild(e),n!==this.parentNode?Object.defineProperty(this,"parentNode",{value:n}):(i=n.findChild(this),i>=0&&n.childNodes.splice(i,1)),n.childNodes.splice(i<o?o:o+1,0,this)}},{key:"insertBefore",value:function(e){if(!(e instanceof t.class.Graph))throw new TypeError("graph is not a Graph instance");if(e===this)throw new Error("can not add myself as a child");var n=e.parentNode,i=void 0,o=void 0;if(!n)throw new Error("no parentNode");o=n.findChild(e),n!==this.parentNode?Object.defineProperty(this,"parentNode",{value:n}):(i=n.findChild(this),i>=0&&n.childNodes.splice(i,1)),n.childNodes.splice(i<o?o-1:o,0,this)}},{key:"findChild",value:function(t){for(var e=this.childNodes.length;e--;)if(this.childNodes[e]===t)return e;return-1}},{key:"removeChild",value:function(t){var e=this.findChild(t);e<0||(this.childNodes.splice(e,1),Object.defineProperty(this,"parentNode",{value:void 0}))}},{key:"checkIfOnOver",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.onoverCheck===!1||!this.hitRange)return!1;var n=this.host.stat.mouse;return null!==n.x&&(this===this.host.tmp.onOverGraph||(t&&this.hitRange(this.host.context),0===e&&this.host.debug.switch&&(this.host.context.save(),this.host.context.strokeStyle="yellow",this.host.context.stroke(),this.host.context.restore()),!!this.host.context.isPointInPath(n.x,n.y)&&(this.host.tmp.onOverGraph=this,!0)))}},{key:"delete",value:function(){this.parentNode&&this.parentNode.removeChild(this),this.host.stat.onover===this&&(this.host.stat.onover=null),this.host.stat.onfocus===this&&(this.host.stat.onfocus=null)}}]),n}(t.class.GraphEventEmitter)},FunctionGraph:function(t){return function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t instanceof Function&&(n.drawer=t),n.style.debugBorderColor="#f00",n}return o(e,t),s(e,[{key:"drawer",value:function(t){this.checkIfOnOver(!0)}},{key:"hitRange",value:function(t){t.beginPath(),t.rect(0,0,this.style.width,this.style.height)}}]),e}(t.class.Graph)},ImageGraph:function(t){return function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t&&n.use(t),n.style.debugBorderColor="#0f0",n}return o(e,t),s(e,[{key:"use",value:function(t){var e=this;if(t instanceof Image)return this.image=t,t.complete?this.resetStyleSize():t.addEventListener("load",function(t){e.resetStyleSize()}),!0;if(t instanceof HTMLCanvasElement)return this.image=t,this.resetStyleSize(),!0;throw new TypeError("Wrong image type")}},{key:"resetStyleSize",value:function(){this.style.width=this.width,this.style.height=this.height}},{key:"drawer",value:function(t){t.drawImage(this.image,0,0),this.checkIfOnOver(!0)}},{key:"hitRange",value:function(t){t.beginPath(),t.rect(0,0,this.style.width,this.style.height)}},{key:"width",get:function(){return this.image instanceof Image?this.image.naturalWidth:this.image instanceof HTMLCanvasElement?this.image.width:0}},{key:"height",get:function(){return this.image instanceof Image?this.image.naturalHeight:this.image instanceof HTMLCanvasElement?this.image.height:0}}]),e}(t.class.FunctionGraph)},CanvasGraph:function(t){return function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.image=document.createElement("canvas"),t.context=t.image.getContext("2d"),t.autoClear=!0,t}return o(e,t),s(e,[{key:"draw",value:function(t){this.autoClear&&this.context.clearRect(0,0,this.width,this.height),t(this.context)}},{key:"width",set:function(t){this.image.width=t}},{key:"height",set:function(t){this.image.height=t}}]),e}(t.class.ImageGraph)},TextGraph:function(t){return function(e){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";r(this,n);var o=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return o._fontString="",o._renderList=null,o.autoSize=!0,o.font=Object.create(t.default.font),o.realtimeRender=!1,o.style.debugBorderColor="#00f",o.text=e,Object.defineProperty(o,"_cache",{configurable:!0}),o}return o(n,e),s(n,[{key:"prepare",value:function(){this._cache||this.realtimeRender||Object.defineProperty(this,"_cache",{value:document.createElement("canvas")});var t="";if(this.font.fontStyle&&(t=this.font.fontStyle),this.font.fontVariant&&(t=t+" "+this.font.fontVariant),this.font.fontWeight&&(t=t+" "+this.font.fontWeight),t=t+" "+this.font.fontSize+"px",this.font.fontFamily&&(t=t+" "+this.font.fontFamily),this._fontString=t,!this.realtimeRender){var e=this._cache,n=e.getContext("2d");if(n.font=t,n.clearRect(0,0,e.width,e.height),this._renderList=this.text.split(/\n/g),this.estimatePadding=Math.max(this.font.shadowBlur+5+Math.max(Math.abs(this.font.shadowOffsetY),Math.abs(this.font.shadowOffsetX)),this.font.strokeWidth+3),this.autoSize){for(var i=0,o=void 0,r="number"==typeof this.font.lineHeigh?this.font.lineHeigh:this.font.fontSize,a=this._renderList.length;a--;)o=n.measureText(this._renderList[a]).width,o>i&&(i=o);e.width=(this.style.width=i)+2*this.estimatePadding,e.height=(this.style.height=this._renderList.length*r)+(r<this.font.fontSize)?2*this.font.fontSize:0+2*this.estimatePadding}else e.width=this.style.width,e.height=this.style.height;n.translate(this.estimatePadding,this.estimatePadding),this.render(n)}}},{key:"render",value:function(t){if(this._renderList){t.font=this._fontString,t.textBaseline="top",t.lineWidth=this.font.strokeWidth,t.fillStyle=this.font.color,t.strokeStyle=this.font.strokeColor,t.shadowBlur=this.font.shadowBlur,t.shadowOffsetX=this.font.shadowOffsetX,t.shadowOffsetY=this.font.shadowOffsetY;for(var e=this._renderList.length;e--;)this.font.fill&&t.fillText(this._renderList[e],0,this.font.lineHeight*e),this.font.strokeWidth&&t.strokeText(this._renderList[e],0,this.font.lineHeight*e)}}},{key:"drawer",value:function(t){this.realtimeRender?(this.checkIfOnOver(!0),this.render(t)):(this._cache||this.prepare(),t.drawImage(this._cache,-this.estimatePadding,-this.estimatePadding),this.checkIfOnOver(!0))}},{key:"hitRange",value:function(t){t.beginPath(),t.rect(0,0,this.style.width,this.style.height)}}]),n}(t.class.FunctionGraph)}};return"function"!=typeof Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(void 0!==i&&null!==i)for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])}return e}),Float32Array.__proto__.from||!function(){var t=[];Float32Array.__proto__.from=function(e,n,i){var o=Float32Array.__proto__;if("function"!=typeof this)throw new TypeError("# is not a constructor");if(this.__proto__!==o)throw new TypeError("this is not a typed array.");if(n=n||function(t){return t},"function"!=typeof n)throw new TypeError("specified argument is not a function");if(e=Object(e),!e.length)return new this(0);t.length=0;for(var r=0;r<e.length;r++)t.push(e[r]);t=t.map(n,i);for(var a=new this(t.length),s=0;s<a.length;s++)a[s]=t[s];return a}}(),function(){if(!window.requestAnimationFrame){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelRequestAnimationFrame=window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,n,i){var o=Date.now(),r=i||Math.max(0,1e3/60-(o-t));e(0);var a=window.setTimeout(function(){e(o+r)},r);return t=o+r,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}}(),n})},{}],5:[function(e,n,i){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(e,n){function i(t,e,n,i,o){if(0===t.length)return-1;for(var r=void 0;n<=i;)r=n+i>>1,e<=t[r].time?n=r:i=r-1;if(o===!0)for(;t[n-1]&&t[n-1].time===t[n].time;)n--;else if(o===!1)for(;t[n+1]&&t[n+1].time===t[n].time;)n++;return n}var o=function(e){function n(t){r(this,n);var e=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.list=[],e.indexMark=0,e.resetTunnel(),e.paused=!0,e.defaultStyle={fontStyle:null,fontWeight:600,
fontVariant:null,color:"#fbfbfb",lineHeight:null,fontSize:30,fontFamily:"Arial",strokeWidth:1,strokeColor:"#000",shadowBlur:10,shadowColor:"#000",shadowOffsetX:0,shadowOffsetY:0,fill:!0,reverse:!1,speed:5,opacity:1},e.canvas=document.createElement("canvas"),Object.assign(e.canvas.style,{position:"absolute",width:"100%",height:"100%",top:0,left:0}),e.context2d=e.canvas.getContext("2d"),e.COL=new c.default(e.canvas),e.COL.autoClear=!1,t.container.appendChild(e.canvas),e.COL_GraphCache=[],e.layer=new e.COL.class.FunctionGraph,e.COL.root.appendChild(e.layer),e.cacheCleanTime=0,e.danmakuMoveTime=0,e.options={allowLines:!1,screenLimit:0,clearWhenTimeReset:!0},e}return s(n,e),u(n,[{key:"start",value:function(){this.paused=!1,this.resetTimeOfDanmakuOnScreen()}},{key:"pause",value:function(){this.paused=!0}},{key:"stop",value:function(){this.COL.clear()}},{key:"load",value:function(t){if(!t||"text"!==t._)return!1;var e=i(this.list,t.time,0,this.list.length-1,!1);return this.list.splice(e,0,t),e<=this.indexMark&&this.indexMark++,!0}},{key:"loadList",value:function(t){var e=!0,n=!1,i=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var a=o.value;this.load(a)}}catch(t){n=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(n)throw i}}}},{key:"unload",value:function(t){if(!t||"text"!==t._)return!1;var e=this.list.indexOf(t);return!(e<0)&&(this.list.splice(e,1),e<this.indexMark&&this.indexMark--,!0)}},{key:"resetTunnel",value:function(){this.tunnels={right:[],left:[],bottom:[],top:[]}}},{key:"draw",value:function(){if(this.enabled){var t=this.frame.time,e=this.COL.canvas.height,n=this.COL.canvas.width,i=this.COL.context,o=void 0,r=void 0;if(this.list.length)for(;this.list[this.indexMark].time<=t&&!(this.options.screenLimit>0&&this.layer.childNodes.length>=this.options.screenLimit);this.indexMark++)if(!document.hidden){r=this.list[this.indexMark],o=this.COL_GraphCache.length?this.COL_GraphCache.shift():new this.COL.class.TextGraph,o.onoverCheck=!1,o.danmaku=r,o.drawn=!1,o.text=this.allowLines?r.text:r.text.replace(/\n/g," "),o.time=t,o.font=Object.create(this.defaultStyle),Object.assign(o.font,r.style),o.style.opacity=o.font.opacity,o.prepare();var a=o.style.height,s=this.getTunnel(r.tunnel,a);o.tunnelNumber=s;var u=(s<0?0:s)%e;switch(o.style.setPositionPoint(o.style.width/2,0),r.tunnel){case 0:case 1:case 3:o.style.top=u;break;case 2:o.style.top=e-u}tunnel[s]=o.style.top+a>e?e-o.style.top-1:a,this.layer.appendChild(o)}var h=!0,c=!1,f=void 0;try{for(var d,v=this.layer.childNodes[Symbol.iterator]();!(h=(d=v.next()).done);h=!0)switch(o=d.value,this.danmakuMoveTime=t,o.drawn?i.clearRect(o.style.x-o.estimatePadding,o.style.y-o.estimatePadding,o._cache.width,o._cache.height):o.drawn=!0,o.danmaku.tunnel){case 0:case 1:var p=o.danmaku.tunnel;o.style.x=(p?n+o.style.width/2:-o.style.width/2)+(p?-1:1)*this.frame.rate*520*(t-o.time)/o.font.speed/1e3,p||o.style.x<-o.style.width||p&&o.style.x>n+o.style.width?this.removeText(o):o.tunnelNumber>=0&&(p||o.style.x+o.style.width/2+30<n||p&&o.style.x-o.style.width/2>30)&&(delete this.tunnels[l[o.danmaku.tunnel]][o.tunnelNumber],o.tunnelNumber=-1);break;case 2:case 3:o.style.x=n/2,t-o.time>1e3*o.font.speed/this.frame.rate&&this.removeText(o)}}catch(t){c=!0,f=t}finally{try{!h&&v.return&&v.return()}finally{if(c)throw f}}if(this.COL.draw(),Date.now()-this.cacheCleanTime>5e3&&(this.cacheCleanTime=Date.now(),this.COL_GraphCache.length>20))for(var m=0;m<this.COL_GraphCache.length&&Date.now()-this.COL_GraphCache[m].removeTime>1e4;m++)this.COL_GraphCache.splice(m,1)}}},{key:"getTunnel",value:function(t,e){var n=this.tunnels[l[t]],i=-1,o=0,r=this.COL.canvas.height;if(e>r)return-1;for(;i<0;)for(var a=0;a<e;a++){if(void 0!==n[o+a]){o+=a+n[o+a];break}if((o+a)%r===0){o+=a;break}if(a===e-1){i=o;break}}return i}},{key:"removeText",value:function(t){this.layer.removeChild(t),t.danmaku=null,t.tunnelNumber>=0&&delete this.tunnels[l[t.danmaku.tunnel]][t.tunnelNumber],t.removeTime=Date.now(),this.COL_GraphCache.push(t)}},{key:"resize",value:function(){this.draw()}},{key:"clear",value:function(){var e=!0,n=!1,i=void 0;try{for(var o,r=this.layer.childNodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0)t=o.value,t.danmaku&&this.removeText(t)}catch(t){n=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(n)throw i}}this.resetTunnel()}},{key:"time",value:function(t){this.indexMark=i(this.list,t,0,this.list.length-1,!0),this.options.clearWhenTimeReset?this.clear():this.resetTimeOfDanmakuOnScreen()}},{key:"resetTimeOfDanmakuOnScreen",value:function(){var t=Date.now(),e=!0,n=!1,i=void 0;try{for(var o,r=this.layer.childNodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var a=o.value;a.danmaku&&(a.time=t-(this.danmakuMoveTime-a.time))}}catch(t){n=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(n)throw i}}}},{key:"danmakuAt",value:function(t,e){var n=[];if(!this.enabled)return n;var i=!0,o=!1,r=void 0;try{for(var a,s=this.layer.childNodes[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var l=a.value;l.danmaku&&l.x<=t&&l.x+l.style.width>=t&&l.y<=e&&l.y+l.style.height>=e&&n.push(l.danmaku)}}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}},{key:"enable",value:function(){this.layer.style.hidden=!1,this.canvas.hidden=!1}},{key:"disable",value:function(){this.layer.style.hidden=!0,this.canvas.hidden=!1,this.clear()}}]),n}(n),l=["right","left","bottom","top"];e.addModule("text2d",o)}Object.defineProperty(i,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=e("../lib/COL/CanvasObjLibrary.js"),c=o(h);i.default=l},{"../lib/COL/CanvasObjLibrary.js":4}],6:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=t("./i18n.js"),u=t("../lib/Object2HTML/Object2HTML.js"),h=t("../lib/danmaku-frame/lib/ResizeSensor.js"),c=i(h),f=t("./NyaPCore.js"),d=l.i18n._,v=function(t){function e(t){function n(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=l[t];return(0,u.Object2HTML)({_:"span",event:e,attr:n,prop:{id:"icon_span_"+t,innerHTML:"<svg height="+i[1]+" width="+i[0]+' id="icon_'+t+'"">'+i[2]+"</svg>"}})}o(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),a=i.eles={};i._playerMode="normal";var s=i.video,l={play:[30,30,'<path d="m10.18814,7.48238l12.08183,7.51799l-12.08183,7.51799l0,-15.03673l0,0l0,0.00074z" stroke-width="3" stroke-linejoin="round"/>'],addDanmaku:[30,30,'<path stroke-width="2" d="m20.514868,20.120359l0.551501,-1.365456l2.206013,-0.341365l-2.757514,1.706821l-13.787251,0l0,-10.240718l16.544766,0l0,8.533897"/><path style="fill-opacity:1;stroke-width:0" d="m12.081653,13.981746l1.928969,0l0,-1.985268l1.978756,0l0,1.985268l1.92897,0l0,2.036509l-1.92897,0l0,1.985268l-1.978756,0l0,-1.985268l-1.928969,0l0,-2.036509z"/>'],danmakuStyle:[40,30,'<path d="m29.15377,16.14291l0.02111,-2.1431c0.00509,-0.54056 -0.42875,-0.98198 -0.96992,-0.98787l-1.34434,-0.013l-0.03905,4.09902l1.34419,0.01376c0.54106,0.00467 0.98357,-0.42842 0.98801,-0.96881l0,0zm-13.90662,-3.25468l-0.03893,4.09917l10.63621,0.10205l0.03855,-4.10088l-10.63583,-0.10035l0,0zm-2.63743,0.99919l-1.78463,1.00731l1.7653,1.04142l1.63913,0.9686l0.03869,-3.9553l-1.65849,0.93797l0,0l0,0z" stroke-width="1.5"/>'],fullPage:[30,30,'<path d="m11.16677,9.76127l-5.23735,5.23922l5.23783,5.23825l1.90512,-1.90509l-3.33364,-3.33316l3.33295,-3.33316l-1.90491,-1.90606l0,0zm7.66526,0l-1.90374,1.90557l3.33296,3.33316l-3.33296,3.33275l1.90374,1.90508l5.23853,-5.23873l-5.23853,-5.23784z" stroke-width="1.3" />'],fullScreen:[30,30,'<rect height="11.1696" width="17.65517" y="9.4152" x="6.17241" stroke-width="1.5"/><path d="m12.36171,11.39435l-3.6047,3.60599l3.60503,3.60532l1.31123,-1.31121l-2.29444,-2.29411l2.29396,-2.29411l-1.31109,-1.31188l0,0zm5.27576,0l-1.31028,1.31155l2.29397,2.29411l-2.29397,2.29383l1.31028,1.3112l3.60552,-3.60565l-3.60552,-3.60504z"/>'],loop:[30,30,'<path stroke-width="1" d="m14.63235,10.09759l5.52492,0l0,0c2.37326,0 4.29716,2.14736 4.29716,4.79625l0,0l0,0c0,1.27204 -0.45273,2.49198 -1.2586,3.39146c-0.80587,0.89946 -1.89888,1.40478 -3.03855,1.40478l-0.61387,0l0,1.37036l-2.45552,-2.74071l2.45552,-2.74071l0,1.37036l0.61387,0c1.01711,0 1.84164,-0.9203 1.84164,-2.05553l0,0l0,0c0,-1.13524 -0.82452,-2.05554 -1.84164,-2.05554l-5.52492,0l0,-2.74071z"/><path stroke-width="1" d="m15.36766,19.90241l-5.52493,0l0,0c-2.37325,0 -4.29716,-2.14734 -4.29716,-4.79624l0,0l0,0c0,-1.27204 0.45273,-2.49199 1.25862,-3.39146c0.80587,-0.89948 1.89886,-1.40479 3.03854,-1.40479l0.61389,0l0,-1.37036l2.45552,2.74071l-2.45552,2.74071l0,-1.37036l-0.61389,0c-1.0171,0 -1.84164,0.9203 -1.84164,2.05554l0,0l0,0c0,1.13524 0.82454,2.05553 1.84164,2.05553l5.52493,0l0,2.74071z"/>'],volume:[30,30,'<ellipse id="volume_circle" style="fill-opacity:.4 !important;" ry="4.5" rx="4.5" cy="15" cx="15" stroke-dasharray="29 300" stroke-width="4"/>']};i._player=(0,u.Object2HTML)({_:"div",attr:{class:"NyaP"},child:[{_:"div",attr:{id:"video_frame"},child:[s,i.danmakuFrame.container]},{_:"div",attr:{id:"control"},child:[{_:"span",attr:{id:"control_left"},child:[n("play",{click:function(t){return i.playOrPause()}},{title:d("play")})]},{_:"span",attr:{id:"control_center"},child:[{_:"div",prop:{id:"progress_info"},child:[{_:"span",child:[{_:"canvas",prop:{id:"progress",pad:10}}]},{_:"span",prop:{id:"time"},child:[{_:"span",prop:{id:"current_time"},child:["00:00"]},"/",{_:"span",prop:{id:"total_time"},child:["00:00"]}]}]},{_:"div",prop:{id:"danmaku_input_frame"},child:[{_:"div",attr:{id:"danmaku_style_pannel"}},n("danmakuStyle",{click:function(t){return i.danmakuStylePannel()}}),{_:"input",attr:{id:"danmaku_input",placeholder:d("Input danmaku here")}},{_:"span",prop:{id:"danmaku_submit",innerHTML:d("Send")}}]}]},{_:"span",attr:{id:"control_right"},child:[n("addDanmaku",{click:function(t){return i.danmakuInput()}},{title:d("danmaku input")}),n("volume",{},{title:d("volume($0)","100%")}),n("loop",{click:function(t){return i.loop()}},{title:d("loop")}),{_:"span",prop:{id:"player_mode"},child:[n("fullPage",{click:function(t){return i.playerMode("fullPage")}},{title:d("full page")}),n("fullScreen",{click:function(t){return i.playerMode("fullScreen")}},{title:d("full screen")})]}]}]}]}),[].slice.call(i._player.querySelectorAll("*")).forEach(function(t){t.id&&!a[t.id]&&(a[t.id]=t)}),setTimeout(function(){a.control.ResizeSensor=new c.default(a.control,function(){return i.refreshProgress()}),i.refreshProgress()},0),i._.progressContext=a.progress.getContext("2d"),(0,f.addEvents)(window,{keydown:function(t){switch(t.code){case"Escape":"fullPage"===i._playerMode&&i.playerMode("normal")}}});var h={main_video:{playing:function(t){a.icon_span_play.classList.add("active_icon")},pause:function(t){a.icon_span_play.classList.remove("active_icon")},stalled:function(t){a.icon_span_play.classList.remove("active_icon")},timeupdate:function(t,e){Date.now()-i._.lastTimeUpdate<30||(void 0===i._.progressX&&(a.current_time.innerHTML=(0,f.formatTime)(s.currentTime,s.duration)),i.drawProgress(),i._.lastTimeUpdate=Date.now(),e||setTimeout(h.main_video.timeupdate,250,null,!0))},loadedmetadata:function(t){a.total_time.innerHTML=(0,f.formatTime)(s.duration,s.duration)},volumechange:function(t){(0,f.setAttrs)(a.volume_circle,{"stroke-dasharray":28.2744*s.volume+" 300",style:"fill-opacity:"+(s.muted?0:.4)+" !important;"}),a.icon_span_volume.setAttribute("title",d("volume($0)",s.muted?d("muted"):(100*s.volume|0)+"%"))},progress:function(t){i.drawProgress()}},progress:{mousemove:function(t){i._.progressX=t.layerX;var e=t.target,n=(t.layerX-e.pad)/(e.offsetWidth-2*e.pad);n=(0,f.limitIn)(n,0,1),a.total_time.innerHTML=(0,f.formatTime)(n*s.duration,s.duration)},mouseout:function(t){i._.progressX=void 0,i.drawProgress(),a.total_time.innerHTML=(0,f.formatTime)(s.duration,s.duration)},click:function(t){var e=t.target,n=(t.layerX-e.pad)/(e.offsetWidth-2*e.pad);n=(0,f.limitIn)(n,0,1),s.currentTime=n*s.duration}},danmaku_container:{click:function(t){return i.playOrPause()}},icon_span_volume:{click:function(t){s.muted=!s.muted},wheel:function(t){t.preventDefault();var e=s.volume+t.deltaY/100;e<0?e=0:e>1&&(e=1),s.volume=e}}};for(var v in h)(0,f.addEvents)(a[v],h[v]);return console.debug(i.eles),i}return a(e,t),s(e,[{key:"danmakuInput",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.eles.danmaku_input_frame.offsetHeight,e=this.eles;e.danmaku_input_frame.style.display=t?"flex":"",e.icon_span_addDanmaku.classList[t?"add":"remove"]("active_icon"),t&&e.danmaku_input.focus()}},{key:"playerMode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal";if("normal"!==t||this._playerMode!==t){var e=this.eles;switch("fullPage"===this._playerMode?(this.player.style.position="",e.icon_span_fullPage.classList.remove("active_icon")):"fullScreen"===this._playerMode&&(e.icon_span_fullScreen.classList.remove("active_icon"),(0,f.exitFullscreen)()),"normal"!==t&&this._playerMode===t&&(t="normal"),t){case"fullPage":this.player.style.position="fixed",e.icon_span_fullPage.classList.add("active_icon");break;case"fullScreen":e.icon_span_fullScreen.classList.add("active_icon"),(0,f.requestFullscreen)(this.player)}this._playerMode=t,this.emit("playerModeChange",t)}}},{key:"loop",value:function(t){void 0===t&&(t=!this.video.loop),this.eles.icon_span_loop.classList[t?"add":"remove"]("active_icon"),this.video.loop=t}},{key:"refreshProgress",value:function(){var t=this.eles.progress;t.width=t.offsetWidth,t.height=t.offsetHeight,this.drawProgress(),this.emit("progressRefresh")}},{key:"drawProgress",value:function(){var t=this._.progressContext,e=this.eles.progress,n=e.width,i=e.height,o=this.video,r=o.duration,a=o.currentTime,s=e.pad,l=n-2*s;t.clearRect(0,0,n,i),t.lineCap="round",t.beginPath(),t.strokeStyle="#e1e1e1",t.lineWidth=11,t.moveTo(s,15),t.lineTo(s+l,15),t.stroke(),t.beginPath(),t.strokeStyle="#888ead",t.lineWidth=3;for(var u=o.played,h=u.length;h--;)t.moveTo(s+u.start(h)/r*l,12),t.lineTo(s+u.end(h)/r*l,12);t.stroke(),t.beginPath(),t.strokeStyle="#C0BBBB",t.lineWidth=2,u=o.buffered;for(var h=u.length;h--;)t.moveTo(s+u.start(h)/r*l,18),t.lineTo(s+u.end(h)/r*l,18);t.stroke(),t.beginPath(),t.strokeStyle="#6cf",t.lineWidth=5,t.moveTo(s,15),t.lineTo(s+l*a/r,15),t.stroke()}}]),e}(f.NyaPlayerCore);window.NyaP=v},{"../lib/Object2HTML/Object2HTML.js":1,"../lib/danmaku-frame/lib/ResizeSensor.js":2,"./NyaPCore.js":7,"./i18n.js":8}],7:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var n in e)t.addEventListener(n,e[n])}function u(t){try{(t.requestFullscreen||t.msRequestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullscreen).call(t)}catch(t){console.error(t),alert(_("Failed to change to fullscreen mode"))}}function h(){var t=document;(t.exitFullscreen||t.msExitFullscreen||t.mozCancelFullScreen||t.webkitCancelFullScreen).call(t)}function c(){var t=document;return!!(t.fullscreen||t.mozFullScreen||t.webkitIsFullScreen||t.msFullscreenElement)}function f(t,e){var n=void 0,i=void 0,o=0|t;return n=o/3600|0,e>=3600&&(o%=3600),i=[d(o/60|0),d(o%60)],e>=3600&&i.unshift(n),i.join(":")}function d(t){return t>9&&t||"0"+t}function v(t,e){for(var n in e)t.setAttribute(n,e[n])}function p(t,e,n){return t<e?e:t>n?n:t}Object.defineProperty(n,"__esModule",{value:!0}),n.limitIn=n.setAttrs=n.padTime=n.formatTime=n.isFullscreen=n.exitFullscreen=n.requestFullscreen=n.addEvents=n.NyaPlayerCore=void 0;var m=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),y=t("../lib/danmaku-frame/src/danmaku-frame.js"),g=t("../lib/danmaku-text/src/danmaku-text.js"),w=i(g),k=t("../lib/Object2HTML/Object2HTML.js");(0,w.default)(y.DanmakuFrame,y.DanmakuFrameModule);var b={muted:!1,volume:1,loop:!1},O=function(){function t(){s(this,t),this._events={}}return m(t,[{key:"emit",value:function(t){this._resolve(t)}},{key:"_resolve",value:function(t){if(t in this._events){var e=this._events[t];try{var n=!0,i=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value;l.call.apply(l,[this,t].concat(a(args)))}}catch(t){i=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}}catch(t){console.error(t)}}}},{key:"on",value:function(t,e){e instanceof Function&&(t in this._events||(this._events[t]=[]),this._events[t].push(e))}},{key:"removeEvent",value:function(t,e){if(t in this._events){if(1===arguments.length)return void delete this._events[t];var n=void 0;(n=this._events[t].indexOf(e)>=0)&&this._events[t].splice(n,1),0===this._events[t].length&&delete this._events[t]}}}]),t}(),P=function(t){function e(t){s(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t=n.opt=Object.assign({},b,t),n._={},n._.video=(0,k.Object2HTML)({_:"video",attr:{id:"main_video"}}),n.danmakuFrame=new y.DanmakuFrame,n.danmakuFrame.enable("text2d"),setTimeout(function(e){["muted","volume","loop","src"].forEach(function(e){void 0!==t[e]&&(n.video[e]=t[e])})},0),n.emit("coreLoad"),n}return r(e,t),m(e,[{key:"play",value:function(){this.video.paused&&this.video.play()}},{key:"pause",value:function(){this.video.paused||this.video.pause()}},{key:"playOrPause",value:function(){this.video.paused?this.play():this.pause()}},{key:"seek",value:function(t){this.video.currentTime=t/1e3}},{key:"addDanmaku",value:function(t){}},{key:"removeDanmaku",value:function(t){}},{key:"Danmaku",value:function(t){}},{key:"player",get:function(){return this._player}},{key:"video",get:function(){return this._.video}},{key:"src",get:function(){return this.video.src},set:function(t){this.video.src=t}}]),e}(O);n.default=P,n.NyaPlayerCore=P,n.addEvents=l,n.requestFullscreen=u,n.exitFullscreen=h,n.isFullscreen=c,n.formatTime=f,n.padTime=d,n.setAttrs=v,n.limitIn=p},{"../lib/Object2HTML/Object2HTML.js":1,"../lib/danmaku-frame/src/danmaku-frame.js":3,"../lib/danmaku-text/src/danmaku-text.js":5}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={lang:null,langs:{},_:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];var r=i.lang&&i.langs[i.lang][t]||t;return n.length&&n.forEach(function(t,e){r=r.replace("$"+e,t)}),r}};String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t}),i.langs["zh-CN"]={play:"",loop:"",Send:"",pause:"",muted:"","full page":"","full screen":"","volume($0)":"$0","danmaku input":"","Input danmaku here":"","Failed to change to fullscreen mode":""};var o=!0,r=!1,a=void 0;try{for(var s,l=navigator.languages[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value;if(i.langs[u]){i.lang=u;break}var h=u.match(/^\w+/)[0];for(var c in i.langs)if(c.startsWith(h)){i.lang=c;break}if(i.lang)break}}catch(t){r=!0,a=t}finally{try{!o&&l.return&&l.return()}finally{if(r)throw a}}console.debug("Language:"+i.lang),n.i18n=i},{}]},{},[6]);